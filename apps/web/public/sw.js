"use strict";(()=>{var Ia=Object.create;var yn=Object.defineProperty;var Ka=Object.getOwnPropertyDescriptor;var Ma=Object.getOwnPropertyNames;var La=Object.getPrototypeOf,Ua=Object.prototype.hasOwnProperty;var Ba=(h,a,s)=>a in h?yn(h,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):h[a]=s;var $a=(h,a)=>()=>(h&&(a=h(h=0)),a);var Fa=(h,a)=>()=>(a||h((a={exports:{}}).exports,a),a.exports);var Va=(h,a,s,f)=>{if(a&&typeof a=="object"||typeof a=="function")for(let d of Ma(a))!Ua.call(h,d)&&d!==s&&yn(h,d,{get:()=>a[d],enumerable:!(f=Ka(a,d))||f.enumerable});return h};var qa=(h,a,s)=>(s=h!=null?Ia(La(h)):{},Va(a||!h||!h.__esModule?yn(s,"default",{value:h,enumerable:!0}):s,h));var Ke=(h,a,s)=>Ba(h,typeof a!="symbol"?a+"":a,s);var P,E=$a(()=>{P=[]});var zi=Fa((Dn,On)=>{E();(function(h,a){typeof Dn=="object"&&typeof On<"u"?On.exports=a():typeof define=="function"&&define.amd?define(a):(h=typeof globalThis<"u"?globalThis:h||self,h.Dexie=a())})(Dn,(function(){"use strict";var h=function(e,t){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},h(e,t)};function a(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");h(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var s=function(){return s=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},s.apply(this,arguments)};function f(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,o;n<i;n++)(o||!(n in t))&&(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))}var d=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,v=Object.keys,w=Array.isArray;typeof Promise<"u"&&!d.Promise&&(d.Promise=Promise);function D(e,t){return typeof t!="object"||v(t).forEach(function(r){e[r]=t[r]}),e}var $=Object.getPrototypeOf,J={}.hasOwnProperty;function X(e,t){return J.call(e,t)}function re(e,t){typeof t=="function"&&(t=t($(e))),(typeof Reflect>"u"?v:Reflect.ownKeys)(t).forEach(function(r){fe(e,r,t[r])})}var Ce=Object.defineProperty;function fe(e,t,r,n){Ce(e,t,D(r&&X(r,"get")&&typeof r.get=="function"?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},n))}function Ye(e){return{from:function(t){return e.prototype=Object.create(t.prototype),fe(e.prototype,"constructor",e),{extend:re.bind(null,e.prototype)}}}}var Ji=Object.getOwnPropertyDescriptor;function In(e,t){var r=Ji(e,t),n;return r||(n=$(e))&&In(n,t)}var Zi=[].slice;function Lt(e,t,r){return Zi.call(e,t,r)}function Kn(e,t){return t(e)}function st(e){if(!e)throw new Error("Assertion Failed")}function Mn(e){d.setImmediate?setImmediate(e):setTimeout(e,0)}function eo(e,t){return e.reduce(function(r,n,i){var o=t(n,i);return o&&(r[o[0]]=o[1]),r},{})}function ve(e,t){if(typeof t=="string"&&X(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var r=[],n=0,i=t.length;n<i;++n){var o=ve(e,t[n]);r.push(o)}return r}var u=t.indexOf(".");if(u!==-1){var c=e[t.substr(0,u)];return c==null?void 0:ve(c,t.substr(u+1))}}function oe(e,t,r){if(!(!e||t===void 0)&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){st(typeof r!="string"&&"length"in r);for(var n=0,i=t.length;n<i;++n)oe(e,t[n],r[n])}else{var o=t.indexOf(".");if(o!==-1){var u=t.substr(0,o),c=t.substr(o+1);if(c==="")r===void 0?w(e)&&!isNaN(parseInt(u))?e.splice(u,1):delete e[u]:e[u]=r;else{var l=e[u];(!l||!X(e,u))&&(l=e[u]={}),oe(l,c,r)}}else r===void 0?w(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=r}}function to(e,t){typeof t=="string"?oe(e,t,void 0):"length"in t&&[].map.call(t,function(r){oe(e,r,void 0)})}function Ln(e){var t={};for(var r in e)X(e,r)&&(t[r]=e[r]);return t}var ro=[].concat;function Un(e){return ro.apply([],e)}var no="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Un([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return d[e]}),Bn=new Set(no.map(function(e){return d[e]}));function $n(e){var t={};for(var r in e)if(X(e,r)){var n=e[r];t[r]=!n||typeof n!="object"||Bn.has(n.constructor)?n:$n(n)}return t}function io(e){for(var t in e)if(X(e,t))return!1;return!0}var ut=null;function Le(e){ut=new WeakMap;var t=Nr(e);return ut=null,t}function Nr(e){if(!e||typeof e!="object")return e;var t=ut.get(e);if(t)return t;if(w(e)){t=[],ut.set(e,t);for(var r=0,n=e.length;r<n;++r)t.push(Nr(e[r]))}else if(Bn.has(e.constructor))t=e;else{var i=$(e);t=i===Object.prototype?{}:Object.create(i),ut.set(e,t);for(var o in e)X(e,o)&&(t[o]=Nr(e[o]))}return t}var oo={}.toString;function kr(e){return oo.call(e).slice(8,-1)}var Sr=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ao=typeof Sr=="symbol"?function(e){var t;return e!=null&&(t=e[Sr])&&t.apply(e)}:function(){return null};function Ue(e,t){var r=e.indexOf(t);return r>=0&&e.splice(r,1),r>=0}var Qe={};function we(e){var t,r,n,i;if(arguments.length===1){if(w(e))return e.slice();if(this===Qe&&typeof e=="string")return[e];if(i=ao(e)){for(r=[];n=i.next(),!n.done;)r.push(n.value);return r}if(e==null)return[e];if(t=e.length,typeof t=="number"){for(r=new Array(t);t--;)r[t]=e[t];return r}return[e]}for(t=arguments.length,r=new Array(t);t--;)r[t]=arguments[t];return r}var Tr=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},so=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],Fn=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Dr=so.concat(Fn),uo={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Xe(e,t){this.name=e,this.message=t}Ye(Xe).from(Error).extend({toString:function(){return this.name+": "+this.message}});function Vn(e,t){return e+". Errors: "+Object.keys(t).map(function(r){return t[r].toString()}).filter(function(r,n,i){return i.indexOf(r)===n}).join(`
`)}function Ut(e,t,r,n){this.failures=t,this.failedKeys=n,this.successCount=r,this.message=Vn(e,t)}Ye(Ut).from(Xe);function Je(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(r){return t[r]}),this.failuresByPos=t,this.message=Vn(e,this.failures)}Ye(Je).from(Xe);var Or=Dr.reduce(function(e,t){return e[t]=t+"Error",e},{}),co=Xe,F=Dr.reduce(function(e,t){var r=t+"Error";function n(i,o){this.name=r,i?typeof i=="string"?(this.message="".concat(i).concat(o?`
 `+o:""),this.inner=o||null):typeof i=="object"&&(this.message="".concat(i.name," ").concat(i.message),this.inner=i):(this.message=uo[t]||r,this.inner=null)}return Ye(n).from(co),e[t]=n,e},{});F.Syntax=SyntaxError,F.Type=TypeError,F.Range=RangeError;var qn=Fn.reduce(function(e,t){return e[t+"Error"]=F[t],e},{});function lo(e,t){if(!e||e instanceof Xe||e instanceof TypeError||e instanceof SyntaxError||!e.name||!qn[e.name])return e;var r=new qn[e.name](t||e.message,e);return"stack"in e&&fe(r,"stack",{get:function(){return this.inner.stack}}),r}var Bt=Dr.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=F[t]),e},{});Bt.ModifyError=Ut,Bt.DexieError=Xe,Bt.BulkError=Je;function Y(){}function ct(e){return e}function fo(e,t){return e==null||e===ct?t:function(r){return t(e(r))}}function Be(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function ho(e,t){return e===Y?t:function(){var r=e.apply(this,arguments);r!==void 0&&(arguments[0]=r);var n=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?Be(n,this.onsuccess):n),i&&(this.onerror=this.onerror?Be(i,this.onerror):i),o!==void 0?o:r}}function po(e,t){return e===Y?t:function(){e.apply(this,arguments);var r=this.onsuccess,n=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?Be(r,this.onsuccess):r),n&&(this.onerror=this.onerror?Be(n,this.onerror):n)}}function mo(e,t){return e===Y?t:function(r){var n=e.apply(this,arguments);D(r,n);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var u=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?Be(i,this.onsuccess):i),o&&(this.onerror=this.onerror?Be(o,this.onerror):o),n===void 0?u===void 0?void 0:u:D(n,u)}}function go(e,t){return e===Y?t:function(){return t.apply(this,arguments)===!1?!1:e.apply(this,arguments)}}function Ar(e,t){return e===Y?t:function(){var r=e.apply(this,arguments);if(r&&typeof r.then=="function"){for(var n=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return r.then(function(){return t.apply(n,o)})}return t.apply(this,arguments)}}var de=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function jn(e,t){de=e}var lt={},Wn=100,Pr=typeof Promise>"u"?[]:(function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,$(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,$(t),e]})(),Hn=Pr[0],Gn=Pr[1],yo=Pr[2],vo=Gn&&Gn.then,$e=Hn&&Hn.constructor,Ir=!!yo;function wo(){queueMicrotask(_o)}var ft=function(e,t){ht.push([e,t]),$t&&(wo(),$t=!1)},Kr=!0,$t=!0,Fe=[],Ft=[],Mr=ct,Ne={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Y,pgp:!1,env:{},finalize:Y},U=Ne,ht=[],Ve=0,Vt=[];function K(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=U;if(typeof e!="function"){if(e!==lt)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Ur(this,this._value);return}this._state=null,this._value=null,++t.ref,Yn(this,e)}var Lr={get:function(){var e=U,t=Ht;function r(n,i){var o=this,u=!e.global&&(e!==U||t!==Ht),c=u&&!Se(),l=new K(function(p,y){Br(o,new zn(Jn(n,e,u,c),Jn(i,e,u,c),p,y,e))});return this._consoleTask&&(l._consoleTask=this._consoleTask),l}return r.prototype=lt,r},set:function(e){fe(this,"then",e&&e.prototype===lt?Lr:{get:function(){return e},set:Lr.set})}};re(K.prototype,{then:Lr,_then:function(e,t){Br(this,new zn(null,null,e,t,U))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],r=arguments[1];return typeof t=="function"?this.then(null,function(n){return n instanceof t?r(n):qt(n)}):this.then(null,function(n){return n&&n.name===t?r(n):qt(n)})},finally:function(e){return this.then(function(t){return K.resolve(e()).then(function(){return t})},function(t){return K.resolve(e()).then(function(){return qt(t)})})},timeout:function(e,t){var r=this;return e<1/0?new K(function(n,i){var o=setTimeout(function(){return i(new F.Timeout(t))},e);r.then(n,i).finally(clearTimeout.bind(null,o))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&fe(K.prototype,Symbol.toStringTag,"Dexie.Promise"),Ne.env=Xn();function zn(e,t,r,n,i){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=r,this.reject=n,this.psd=i}re(K,{all:function(){var e=we.apply(null,arguments).map(Gt);return new K(function(t,r){e.length===0&&t([]);var n=e.length;e.forEach(function(i,o){return K.resolve(i).then(function(u){e[o]=u,--n||t(e)},r)})})},resolve:function(e){if(e instanceof K)return e;if(e&&typeof e.then=="function")return new K(function(r,n){e.then(r,n)});var t=new K(lt,!0,e);return t},reject:qt,race:function(){var e=we.apply(null,arguments).map(Gt);return new K(function(t,r){e.map(function(n){return K.resolve(n).then(t,r)})})},PSD:{get:function(){return U},set:function(e){return U=e}},totalEchoes:{get:function(){return Ht}},newPSD:ke,usePSD:qe,scheduler:{get:function(){return ft},set:function(e){ft=e}},rejectionMapper:{get:function(){return Mr},set:function(e){Mr=e}},follow:function(e,t){return new K(function(r,n){return ke(function(i,o){var u=U;u.unhandleds=[],u.onunhandled=o,u.finalize=Be(function(){var c=this;Eo(function(){c.unhandleds.length===0?i():o(c.unhandleds[0])})},u.finalize),e()},t,r,n)})}}),$e&&($e.allSettled&&fe(K,"allSettled",function(){var e=we.apply(null,arguments).map(Gt);return new K(function(t){e.length===0&&t([]);var r=e.length,n=new Array(r);e.forEach(function(i,o){return K.resolve(i).then(function(u){return n[o]={status:"fulfilled",value:u}},function(u){return n[o]={status:"rejected",reason:u}}).then(function(){return--r||t(n)})})})}),$e.any&&typeof AggregateError<"u"&&fe(K,"any",function(){var e=we.apply(null,arguments).map(Gt);return new K(function(t,r){e.length===0&&r(new AggregateError([]));var n=e.length,i=new Array(n);e.forEach(function(o,u){return K.resolve(o).then(function(c){return t(c)},function(c){i[u]=c,--n||r(new AggregateError(i))})})})}),$e.withResolvers&&(K.withResolvers=$e.withResolvers));function Yn(e,t){try{t(function(r){if(e._state===null){if(r===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&Ze();r&&typeof r.then=="function"?Yn(e,function(i,o){r instanceof K?r._then(i,o):r.then(i,o)}):(e._state=!0,e._value=r,Qn(e)),n&&et()}},Ur.bind(null,e))}catch(r){Ur(e,r)}}function Ur(e,t){if(Ft.push(t),e._state===null){var r=e._lib&&Ze();t=Mr(t),e._state=!1,e._value=t,xo(e),Qn(e),r&&et()}}function Qn(e){var t=e._listeners;e._listeners=[];for(var r=0,n=t.length;r<n;++r)Br(e,t[r]);var i=e._PSD;--i.ref||i.finalize(),Ve===0&&(++Ve,ft(function(){--Ve===0&&$r()},[]))}function Br(e,t){if(e._state===null){e._listeners.push(t);return}var r=e._state?t.onFulfilled:t.onRejected;if(r===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Ve,ft(bo,[r,e,t])}function bo(e,t,r){try{var n,i=t._value;!t._state&&Ft.length&&(Ft=[]),n=de&&t._consoleTask?t._consoleTask.run(function(){return e(i)}):e(i),!t._state&&Ft.indexOf(i)===-1&&Ro(t),r.resolve(n)}catch(o){r.reject(o)}finally{--Ve===0&&$r(),--r.psd.ref||r.psd.finalize()}}function _o(){qe(Ne,function(){Ze()&&et()})}function Ze(){var e=Kr;return Kr=!1,$t=!1,e}function et(){var e,t,r;do for(;ht.length>0;)for(e=ht,ht=[],r=e.length,t=0;t<r;++t){var n=e[t];n[0].apply(null,n[1])}while(ht.length>0);Kr=!0,$t=!0}function $r(){var e=Fe;Fe=[],e.forEach(function(n){n._PSD.onunhandled.call(null,n._value,n)});for(var t=Vt.slice(0),r=t.length;r;)t[--r]()}function Eo(e){function t(){e(),Vt.splice(Vt.indexOf(t),1)}Vt.push(t),++Ve,ft(function(){--Ve===0&&$r()},[])}function xo(e){Fe.some(function(t){return t._value===e._value})||Fe.push(e)}function Ro(e){for(var t=Fe.length;t;)if(Fe[--t]._value===e._value){Fe.splice(t,1);return}}function qt(e){return new K(lt,!1,e)}function Q(e,t){var r=U;return function(){var n=Ze(),i=U;try{return Te(r,!0),e.apply(this,arguments)}catch(o){t&&t(o)}finally{Te(i,!1),n&&et()}}}var te={awaits:0,echoes:0,id:0},Co=0,jt=[],Wt=0,Ht=0,No=0;function ke(e,t,r,n){var i=U,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++No,Ne.env,o.env=Ir?{Promise:K,PromiseProp:{value:K,configurable:!0,writable:!0},all:K.all,race:K.race,allSettled:K.allSettled,any:K.any,resolve:K.resolve,reject:K.reject}:{},t&&D(o,t),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var u=qe(o,e,r,n);return o.ref===0&&o.finalize(),u}function tt(){return te.id||(te.id=++Co),++te.awaits,te.echoes+=Wn,te.id}function Se(){return te.awaits?(--te.awaits===0&&(te.id=0),te.echoes=te.awaits*Wn,!0):!1}(""+vo).indexOf("[native code]")===-1&&(tt=Se=Y);function Gt(e){return te.echoes&&e&&e.constructor===$e?(tt(),e.then(function(t){return Se(),t},function(t){return Se(),ee(t)})):e}function ko(e){++Ht,(!te.echoes||--te.echoes===0)&&(te.echoes=te.awaits=te.id=0),jt.push(U),Te(e,!0)}function So(){var e=jt[jt.length-1];jt.pop(),Te(e,!1)}function Te(e,t){var r=U;if((t?te.echoes&&(!Wt++||e!==U):Wt&&(!--Wt||e!==U))&&queueMicrotask(t?ko.bind(null,e):So),e!==U&&(U=e,r===Ne&&(Ne.env=Xn()),Ir)){var n=Ne.env.Promise,i=e.env;(r.global||e.global)&&(Object.defineProperty(d,"Promise",i.PromiseProp),n.all=i.all,n.race=i.race,n.resolve=i.resolve,n.reject=i.reject,i.allSettled&&(n.allSettled=i.allSettled),i.any&&(n.any=i.any))}}function Xn(){var e=d.Promise;return Ir?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(d,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function qe(e,t,r,n,i){var o=U;try{return Te(e,!0),t(r,n,i)}finally{Te(o,!1)}}function Jn(e,t,r,n){return typeof e!="function"?e:function(){var i=U;r&&tt(),Te(t,!0);try{return e.apply(this,arguments)}finally{Te(i,!1),n&&queueMicrotask(Se)}}}function Fr(e){Promise===$e&&te.echoes===0?Wt===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}var ee=K.reject;function Vr(e,t,r,n){if(!e.idbdb||!e._state.openComplete&&!U.letThrough&&!e._vip){if(e._state.openComplete)return ee(new F.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._state.autoOpen)return ee(new F.DatabaseClosed);e.open().catch(Y)}return e._state.dbReadyPromise.then(function(){return Vr(e,t,r,n)})}else{var i=e._createTransaction(t,r,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(o){return o.name===Or.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return Vr(e,t,r,n)})):ee(o)}return i._promise(t,function(o,u){return ke(function(){return U.trans=i,n(o,u,i)})}).then(function(o){if(t==="readwrite")try{i.idbtrans.commit()}catch{}return t==="readonly"?o:i._completion.then(function(){return o})})}}var Zn="4.2.1",je="\uFFFF",qr=-1/0,be="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",ei="String expected.",rt=[],zt="__dbnames",jr="readonly",Wr="readwrite";function We(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var ti={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Yt(e){return typeof e=="string"&&!/\./.test(e)?function(t){return t[e]===void 0&&e in t&&(t=Le(t),delete t[e]),t}:function(t){return t}}function ri(){throw F.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function G(e,t){try{var r=ni(e),n=ni(t);if(r!==n)return r==="Array"?1:n==="Array"?-1:r==="binary"?1:n==="binary"?-1:r==="string"?1:n==="string"?-1:r==="Date"?1:n!=="Date"?NaN:-1;switch(r){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return Do(ii(e),ii(t));case"Array":return To(e,t)}}catch{}return NaN}function To(e,t){for(var r=e.length,n=t.length,i=r<n?r:n,o=0;o<i;++o){var u=G(e[o],t[o]);if(u!==0)return u}return r===n?0:r<n?-1:1}function Do(e,t){for(var r=e.length,n=t.length,i=r<n?r:n,o=0;o<i;++o)if(e[o]!==t[o])return e[o]<t[o]?-1:1;return r===n?0:r<n?-1:1}function ni(e){var t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";var r=kr(e);return r==="ArrayBuffer"?"binary":r}function ii(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function Qt(e,t,r){var n=e.schema.yProps;return n?(t&&r.numFailures>0&&(t=t.filter(function(i,o){return!r.failures[o]})),Promise.all(n.map(function(i){var o=i.updatesTable;return t?e.db.table(o).where("k").anyOf(t).delete():e.db.table(o).clear()})).then(function(){return r})):r}var pt=(function(){function e(t){this["@@propmod"]=t}return e.prototype.execute=function(t){var r,n=this["@@propmod"];if(n.add!==void 0){var i=n.add;if(w(i))return f(f([],w(t)?t:[],!0),i,!0).sort();if(typeof i=="number")return(Number(t)||0)+i;if(typeof i=="bigint")try{return BigInt(t)+i}catch{return BigInt(0)+i}throw new TypeError("Invalid term ".concat(i))}if(n.remove!==void 0){var o=n.remove;if(w(o))return w(t)?t.filter(function(c){return!o.includes(c)}).sort():[];if(typeof o=="number")return Number(t)-o;if(typeof o=="bigint")try{return BigInt(t)-o}catch{return BigInt(0)-o}throw new TypeError("Invalid subtrahend ".concat(o))}var u=(r=n.replacePrefix)===null||r===void 0?void 0:r[0];return u&&typeof t=="string"&&t.startsWith(u)?n.replacePrefix[1]+t.substring(u.length):t},e})();function oi(e,t){for(var r=v(t),n=r.length,i=!1,o=0;o<n;++o){var u=r[o],c=t[u],l=ve(e,u);c instanceof pt?(oe(e,u,c.execute(l)),i=!0):l!==c&&(oe(e,u,c),i=!0)}return i}var ai=(function(){function e(){}return e.prototype._trans=function(t,r,n){var i=this._tx||U.trans,o=this.name,u=de&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(t==="readonly"?"read":"write"," ").concat(this.name));function c(y,m,R){if(!R.schema[o])throw new F.NotFound("Table "+o+" not part of transaction");return r(R.idbtrans,R)}var l=Ze();try{var p=i&&i.db._novip===this.db._novip?i===U.trans?i._promise(t,c,n):ke(function(){return i._promise(t,c,n)},{trans:i,transless:U.transless||U}):Vr(this.db,t,[this.name],c);return u&&(p._consoleTask=u,p=p.catch(function(y){return console.trace(y),ee(y)})),p}finally{l&&et()}},e.prototype.get=function(t,r){var n=this;return t&&t.constructor===Object?this.where(t).first(r):t==null?ee(new F.Type("Invalid argument to Table.get()")):this._trans("readonly",function(i){return n.core.get({trans:i,key:t}).then(function(o){return n.hook.reading.fire(o)})}).then(r)},e.prototype.where=function(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(w(t))return new this.db.WhereClause(this,"[".concat(t.join("+"),"]"));var r=v(t);if(r.length===1)return this.where(r[0]).equals(t[r[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter(function(y){if(y.compound&&r.every(function(R){return y.keyPath.indexOf(R)>=0})){for(var m=0;m<r.length;++m)if(r.indexOf(y.keyPath[m])===-1)return!1;return!0}return!1}).sort(function(y,m){return y.keyPath.length-m.keyPath.length})[0];if(n&&this.db._maxKey!==je){var i=n.keyPath.slice(0,r.length);return this.where(i).equals(i.map(function(y){return t[y]}))}!n&&de&&console.warn("The query ".concat(JSON.stringify(t)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(r.join("+"),"]"));var o=this.schema.idxByName;function u(y,m){return G(y,m)===0}var c=r.reduce(function(y,m){var R=y[0],O=y[1],g=o[m],b=t[m];return[R||g,R||!g?We(O,g&&g.multi?function(x){var C=ve(x,m);return w(C)&&C.some(function(k){return u(b,k)})}:function(x){return u(b,ve(x,m))}):O]},[null,null]),l=c[0],p=c[1];return l?this.where(l.name).equals(t[l.keyPath]).filter(p):n?this.filter(p):this.where(r).equals("")},e.prototype.filter=function(t){return this.toCollection().and(t)},e.prototype.count=function(t){return this.toCollection().count(t)},e.prototype.offset=function(t){return this.toCollection().offset(t)},e.prototype.limit=function(t){return this.toCollection().limit(t)},e.prototype.each=function(t){return this.toCollection().each(t)},e.prototype.toArray=function(t){return this.toCollection().toArray(t)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(t){return new this.db.Collection(new this.db.WhereClause(this,w(t)?"[".concat(t.join("+"),"]"):t))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(t){var r=this,n=r.db,i=r.name;this.schema.mappedClass=t,t.prototype instanceof ri&&(t=(function(l){a(p,l);function p(){return l!==null&&l.apply(this,arguments)||this}return Object.defineProperty(p.prototype,"db",{get:function(){return n},enumerable:!1,configurable:!0}),p.prototype.table=function(){return i},p})(t));for(var o=new Set,u=t.prototype;u;u=$(u))Object.getOwnPropertyNames(u).forEach(function(l){return o.add(l)});var c=function(l){if(!l)return l;var p=Object.create(t.prototype);for(var y in l)if(!o.has(y))try{p[y]=l[y]}catch{}return p};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=c,this.hook("reading",c),t},e.prototype.defineClass=function(){function t(r){D(this,r)}return this.mapToClass(t)},e.prototype.add=function(t,r){var n=this,i=this.schema.primKey,o=i.auto,u=i.keyPath,c=t;return u&&o&&(c=Yt(u)(t)),this._trans("readwrite",function(l){return n.core.mutate({trans:l,type:"add",keys:r!=null?[r]:null,values:[c]})}).then(function(l){return l.numFailures?K.reject(l.failures[0]):l.lastResult}).then(function(l){if(u)try{oe(t,u,l)}catch{}return l})},e.prototype.upsert=function(t,r){var n=this,i=this.schema.primKey.keyPath;return this._trans("readwrite",function(o){return n.core.get({trans:o,key:t}).then(function(u){var c=u??{};return oi(c,r),i&&oe(c,i,t),n.core.mutate({trans:o,type:"put",values:[c],keys:[t],upsert:!0,updates:{keys:[t],changeSpecs:[r]}}).then(function(l){return l.numFailures?K.reject(l.failures[0]):!!u})})})},e.prototype.update=function(t,r){if(typeof t=="object"&&!w(t)){var n=ve(t,this.schema.primKey.keyPath);return n===void 0?ee(new F.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(r)}else return this.where(":id").equals(t).modify(r)},e.prototype.put=function(t,r){var n=this,i=this.schema.primKey,o=i.auto,u=i.keyPath,c=t;return u&&o&&(c=Yt(u)(t)),this._trans("readwrite",function(l){return n.core.mutate({trans:l,type:"put",values:[c],keys:r!=null?[r]:null})}).then(function(l){return l.numFailures?K.reject(l.failures[0]):l.lastResult}).then(function(l){if(u)try{oe(t,u,l)}catch{}return l})},e.prototype.delete=function(t){var r=this;return this._trans("readwrite",function(n){return r.core.mutate({trans:n,type:"delete",keys:[t]}).then(function(i){return Qt(r,[t],i)}).then(function(i){return i.numFailures?K.reject(i.failures[0]):void 0})})},e.prototype.clear=function(){var t=this;return this._trans("readwrite",function(r){return t.core.mutate({trans:r,type:"deleteRange",range:ti}).then(function(n){return Qt(t,null,n)})}).then(function(r){return r.numFailures?K.reject(r.failures[0]):void 0})},e.prototype.bulkGet=function(t){var r=this;return this._trans("readonly",function(n){return r.core.getMany({keys:t,trans:n}).then(function(i){return i.map(function(o){return r.hook.reading.fire(o)})})})},e.prototype.bulkAdd=function(t,r,n){var i=this,o=Array.isArray(r)?r:void 0;n=n||(o?void 0:r);var u=n?n.allKeys:void 0;return this._trans("readwrite",function(c){var l=i.schema.primKey,p=l.auto,y=l.keyPath;if(y&&o)throw new F.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(o&&o.length!==t.length)throw new F.InvalidArgument("Arguments objects and keys must have the same length");var m=t.length,R=y&&p?t.map(Yt(y)):t;return i.core.mutate({trans:c,type:"add",keys:o,values:R,wantResults:u}).then(function(O){var g=O.numFailures,b=O.results,x=O.lastResult,C=O.failures,k=u?b:x;if(g===0)return k;throw new Je("".concat(i.name,".bulkAdd(): ").concat(g," of ").concat(m," operations failed"),C)})})},e.prototype.bulkPut=function(t,r,n){var i=this,o=Array.isArray(r)?r:void 0;n=n||(o?void 0:r);var u=n?n.allKeys:void 0;return this._trans("readwrite",function(c){var l=i.schema.primKey,p=l.auto,y=l.keyPath;if(y&&o)throw new F.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(o&&o.length!==t.length)throw new F.InvalidArgument("Arguments objects and keys must have the same length");var m=t.length,R=y&&p?t.map(Yt(y)):t;return i.core.mutate({trans:c,type:"put",keys:o,values:R,wantResults:u}).then(function(O){var g=O.numFailures,b=O.results,x=O.lastResult,C=O.failures,k=u?b:x;if(g===0)return k;throw new Je("".concat(i.name,".bulkPut(): ").concat(g," of ").concat(m," operations failed"),C)})})},e.prototype.bulkUpdate=function(t){var r=this,n=this.core,i=t.map(function(c){return c.key}),o=t.map(function(c){return c.changes}),u=[];return this._trans("readwrite",function(c){return n.getMany({trans:c,keys:i,cache:"clone"}).then(function(l){var p=[],y=[];t.forEach(function(R,O){var g=R.key,b=R.changes,x=l[O];if(x){for(var C=0,k=Object.keys(b);C<k.length;C++){var S=k[C],T=b[S];if(S===r.schema.primKey.keyPath){if(G(T,g)!==0)throw new F.Constraint("Cannot update primary key in bulkUpdate()")}else oe(x,S,T)}u.push(O),p.push(g),y.push(x)}});var m=p.length;return n.mutate({trans:c,type:"put",keys:p,values:y,updates:{keys:i,changeSpecs:o}}).then(function(R){var O=R.numFailures,g=R.failures;if(O===0)return m;for(var b=0,x=Object.keys(g);b<x.length;b++){var C=x[b],k=u[Number(C)];if(k!=null){var S=g[C];delete g[C],g[k]=S}}throw new Je("".concat(r.name,".bulkUpdate(): ").concat(O," of ").concat(m," operations failed"),g)})})})},e.prototype.bulkDelete=function(t){var r=this,n=t.length;return this._trans("readwrite",function(i){return r.core.mutate({trans:i,type:"delete",keys:t}).then(function(o){return Qt(r,t,o)})}).then(function(i){var o=i.numFailures,u=i.lastResult,c=i.failures;if(o===0)return u;throw new Je("".concat(r.name,".bulkDelete(): ").concat(o," of ").concat(n," operations failed"),c)})},e})();function dt(e){var t={},r=function(c,l){if(l){for(var p=arguments.length,y=new Array(p-1);--p;)y[p-1]=arguments[p];return t[c].subscribe.apply(null,y),e}else if(typeof c=="string")return t[c]};r.addEventType=o;for(var n=1,i=arguments.length;n<i;++n)o(arguments[n]);return r;function o(c,l,p){if(typeof c=="object")return u(c);l||(l=go),p||(p=Y);var y={subscribers:[],fire:p,subscribe:function(m){y.subscribers.indexOf(m)===-1&&(y.subscribers.push(m),y.fire=l(y.fire,m))},unsubscribe:function(m){y.subscribers=y.subscribers.filter(function(R){return R!==m}),y.fire=y.subscribers.reduce(l,p)}};return t[c]=r[c]=y,y}function u(c){v(c).forEach(function(l){var p=c[l];if(w(p))o(l,c[l][0],c[l][1]);else if(p==="asap")var y=o(l,ct,function(){for(var R=arguments.length,O=new Array(R);R--;)O[R]=arguments[R];y.subscribers.forEach(function(g){Mn(function(){g.apply(null,O)})})});else throw new F.InvalidArgument("Invalid event config")})}}function mt(e,t){return Ye(t).from({prototype:e}),t}function Oo(e){return mt(ai.prototype,function(r,n,i){this.db=e,this._tx=i,this.name=r,this.schema=n,this.hook=e._allTables[r]?e._allTables[r].hook:dt(null,{creating:[ho,Y],reading:[fo,ct],updating:[mo,Y],deleting:[po,Y]})})}function nt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Hr(e,t){e.filter=We(e.filter,t)}function Gr(e,t,r){var n=e.replayFilter;e.replayFilter=n?function(){return We(n(),t())}:t,e.justLimit=r&&!n}function Ao(e,t){e.isMatch=We(e.isMatch,t)}function Xt(e,t){if(e.isPrimKey)return t.primaryKey;var r=t.getIndexByKeyPath(e.index);if(!r)throw new F.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return r}function si(e,t,r){var n=Xt(e,t.schema);return t.openCursor({trans:r,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:n,range:e.range}})}function Jt(e,t,r,n){var i=e.replayFilter?We(e.filter,e.replayFilter()):e.filter;if(e.or){var o={},u=function(c,l,p){if(!i||i(l,p,function(R){return l.stop(R)},function(R){return l.fail(R)})){var y=l.primaryKey,m=""+y;m==="[object ArrayBuffer]"&&(m=""+new Uint8Array(y)),X(o,m)||(o[m]=!0,t(c,l,p))}};return Promise.all([e.or._iterate(u,r),ui(si(e,n,r),e.algorithm,u,!e.keysOnly&&e.valueMapper)])}else return ui(si(e,n,r),We(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function ui(e,t,r,n){var i=n?function(u,c,l){return r(n(u),c,l)}:r,o=Q(i);return e.then(function(u){if(u)return u.start(function(){var c=function(){return u.continue()};(!t||t(u,function(l){return c=l},function(l){u.stop(l),c=Y},function(l){u.fail(l),c=Y}))&&o(u.value,u,function(l){return c=l}),c()})})}var Po=(function(){function e(){}return e.prototype._read=function(t,r){var n=this._ctx;return n.error?n.table._trans(null,ee.bind(null,n.error)):n.table._trans("readonly",t).then(r)},e.prototype._write=function(t){var r=this._ctx;return r.error?r.table._trans(null,ee.bind(null,r.error)):r.table._trans("readwrite",t,"locked")},e.prototype._addAlgorithm=function(t){var r=this._ctx;r.algorithm=We(r.algorithm,t)},e.prototype._iterate=function(t,r){return Jt(this._ctx,t,r,this._ctx.table.core)},e.prototype.clone=function(t){var r=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return t&&D(n,t),r._ctx=n,r},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(t){var r=this._ctx;return this._read(function(n){return Jt(r,t,n,r.table.core)})},e.prototype.count=function(t){var r=this;return this._read(function(n){var i=r._ctx,o=i.table.core;if(nt(i,!0))return o.count({trans:n,query:{index:Xt(i,o.schema),range:i.range}}).then(function(c){return Math.min(c,i.limit)});var u=0;return Jt(i,function(){return++u,!1},n,o).then(function(){return u})}).then(t)},e.prototype.sortBy=function(t,r){var n=t.split(".").reverse(),i=n[0],o=n.length-1;function u(p,y){return y?u(p[n[y]],y-1):p[i]}var c=this._ctx.dir==="next"?1:-1;function l(p,y){var m=u(p,o),R=u(y,o);return G(m,R)*c}return this.toArray(function(p){return p.sort(l)}).then(r)},e.prototype.toArray=function(t){var r=this;return this._read(function(n){var i=r._ctx;if(i.dir==="next"&&nt(i,!0)&&i.limit>0){var o=i.valueMapper,u=Xt(i,i.table.core.schema);return i.table.core.query({trans:n,limit:i.limit,values:!0,query:{index:u,range:i.range}}).then(function(l){var p=l.result;return o?p.map(o):p})}else{var c=[];return Jt(i,function(l){return c.push(l)},n,i.table.core).then(function(){return c})}},t)},e.prototype.offset=function(t){var r=this._ctx;return t<=0?this:(r.offset+=t,nt(r)?Gr(r,function(){var n=t;return function(i,o){return n===0?!0:n===1?(--n,!1):(o(function(){i.advance(n),n=0}),!1)}}):Gr(r,function(){var n=t;return function(){return--n<0}}),this)},e.prototype.limit=function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),Gr(this._ctx,function(){var r=t;return function(n,i,o){return--r<=0&&i(o),r>=0}},!0),this},e.prototype.until=function(t,r){return Hr(this._ctx,function(n,i,o){return t(n.value)?(i(o),r):!0}),this},e.prototype.first=function(t){return this.limit(1).toArray(function(r){return r[0]}).then(t)},e.prototype.last=function(t){return this.reverse().first(t)},e.prototype.filter=function(t){return Hr(this._ctx,function(r){return t(r.value)}),Ao(this._ctx,t),this},e.prototype.and=function(t){return this.filter(t)},e.prototype.or=function(t){return new this.db.WhereClause(this._ctx.table,t,this)},e.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(t){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(n,i){t(i.key,i)})},e.prototype.eachUniqueKey=function(t){return this._ctx.unique="unique",this.eachKey(t)},e.prototype.eachPrimaryKey=function(t){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(n,i){t(i.primaryKey,i)})},e.prototype.keys=function(t){var r=this._ctx;r.keysOnly=!r.isMatch;var n=[];return this.each(function(i,o){n.push(o.key)}).then(function(){return n}).then(t)},e.prototype.primaryKeys=function(t){var r=this._ctx;if(r.dir==="next"&&nt(r,!0)&&r.limit>0)return this._read(function(i){var o=Xt(r,r.table.core.schema);return r.table.core.query({trans:i,values:!1,limit:r.limit,query:{index:o,range:r.range}})}).then(function(i){var o=i.result;return o}).then(t);r.keysOnly=!r.isMatch;var n=[];return this.each(function(i,o){n.push(o.primaryKey)}).then(function(){return n}).then(t)},e.prototype.uniqueKeys=function(t){return this._ctx.unique="unique",this.keys(t)},e.prototype.firstKey=function(t){return this.limit(1).keys(function(r){return r[0]}).then(t)},e.prototype.lastKey=function(t){return this.reverse().firstKey(t)},e.prototype.distinct=function(){var t=this._ctx,r=t.index&&t.table.schema.idxByName[t.index];if(!r||!r.multi)return this;var n={};return Hr(this._ctx,function(i){var o=i.primaryKey.toString(),u=X(n,o);return n[o]=!0,!u}),this},e.prototype.modify=function(t){var r=this,n=this._ctx;return this._write(function(i){var o;typeof t=="function"?o=t:o=function(C){return oi(C,t)};var u=n.table.core,c=u.schema.primaryKey,l=c.outbound,p=c.extractKey,y=200,m=r.db._options.modifyChunkSize;m&&(typeof m=="object"?y=m[u.name]||m["*"]||200:y=m);var R=[],O=0,g=[],b=function(C,k){var S=k.failures,T=k.numFailures;O+=C-T;for(var N=0,A=v(S);N<A.length;N++){var M=A[N];R.push(S[M])}},x=t===ci;return r.clone().primaryKeys().then(function(C){var k=nt(n)&&n.limit===1/0&&(typeof t!="function"||x)&&{index:n.index,range:n.range},S=function(T){var N=Math.min(y,C.length-T),A=C.slice(T,T+N);return(x?Promise.resolve([]):u.getMany({trans:i,keys:A,cache:"immutable"})).then(function(M){var I=[],V=[],W=l?[]:null,L=x?A:[];if(!x)for(var j=0;j<N;++j){var q=M[j],z={value:Le(q),primKey:C[T+j]};o.call(z,z.value,z)!==!1&&(z.value==null?L.push(C[T+j]):!l&&G(p(q),p(z.value))!==0?(L.push(C[T+j]),I.push(z.value)):(V.push(z.value),l&&W.push(C[T+j])))}return Promise.resolve(I.length>0&&u.mutate({trans:i,type:"add",values:I}).then(function(B){for(var Z in B.failures)L.splice(parseInt(Z),1);b(I.length,B)})).then(function(){return(V.length>0||k&&typeof t=="object")&&u.mutate({trans:i,type:"put",keys:W,values:V,criteria:k,changeSpec:typeof t!="function"&&t,isAdditionalChunk:T>0}).then(function(B){return b(V.length,B)})}).then(function(){return(L.length>0||k&&x)&&u.mutate({trans:i,type:"delete",keys:L,criteria:k,isAdditionalChunk:T>0}).then(function(B){return Qt(n.table,L,B)}).then(function(B){return b(L.length,B)})}).then(function(){return C.length>T+N&&S(T+y)})})};return S(0).then(function(){if(R.length>0)throw new Ut("Error modifying one or more objects",R,O,g);return C.length})})})},e.prototype.delete=function(){var t=this._ctx,r=t.range;return nt(t)&&!t.table.schema.yProps&&(t.isPrimKey||r.type===3)?this._write(function(n){var i=t.table.core.schema.primaryKey,o=r;return t.table.core.count({trans:n,query:{index:i,range:o}}).then(function(u){return t.table.core.mutate({trans:n,type:"deleteRange",range:o}).then(function(c){var l=c.failures,p=c.numFailures;if(p)throw new Ut("Could not delete some values",Object.keys(l).map(function(y){return l[y]}),u-p);return u-p})})}):this.modify(ci)},e})(),ci=function(e,t){return t.value=null};function Io(e){return mt(Po.prototype,function(r,n){this.db=e;var i=ti,o=null;if(n)try{i=n()}catch(p){o=p}var u=r._ctx,c=u.table,l=c.hook.reading.fire;this._ctx={table:c,index:u.index,isPrimKey:!u.index||c.schema.primKey.keyPath&&u.index===c.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:o,or:u.or,valueMapper:l!==ct?l:null}})}function Ko(e,t){return e<t?-1:e===t?0:1}function Mo(e,t){return e>t?-1:e===t?0:1}function ue(e,t,r){var n=e instanceof fi?new e.Collection(e):e;return n._ctx.error=r?new r(t):new TypeError(t),n}function it(e){return new e.Collection(e,function(){return li("")}).limit(0)}function Lo(e){return e==="next"?function(t){return t.toUpperCase()}:function(t){return t.toLowerCase()}}function Uo(e){return e==="next"?function(t){return t.toLowerCase()}:function(t){return t.toUpperCase()}}function Bo(e,t,r,n,i,o){for(var u=Math.min(e.length,n.length),c=-1,l=0;l<u;++l){var p=t[l];if(p!==n[l])return i(e[l],r[l])<0?e.substr(0,l)+r[l]+r.substr(l+1):i(e[l],n[l])<0?e.substr(0,l)+n[l]+r.substr(l+1):c>=0?e.substr(0,c)+t[c]+r.substr(c+1):null;i(e[l],p)<0&&(c=l)}return u<n.length&&o==="next"?e+r.substr(e.length):u<e.length&&o==="prev"?e.substr(0,r.length):c<0?null:e.substr(0,c)+n[c]+r.substr(c+1)}function Zt(e,t,r,n){var i,o,u,c,l,p,y,m=r.length;if(!r.every(function(b){return typeof b=="string"}))return ue(e,ei);function R(b){i=Lo(b),o=Uo(b),u=b==="next"?Ko:Mo;var x=r.map(function(C){return{lower:o(C),upper:i(C)}}).sort(function(C,k){return u(C.lower,k.lower)});c=x.map(function(C){return C.upper}),l=x.map(function(C){return C.lower}),p=b,y=b==="next"?"":n}R("next");var O=new e.Collection(e,function(){return De(c[0],l[m-1]+n)});O._ondirectionchange=function(b){R(b)};var g=0;return O._addAlgorithm(function(b,x,C){var k=b.key;if(typeof k!="string")return!1;var S=o(k);if(t(S,l,g))return!0;for(var T=null,N=g;N<m;++N){var A=Bo(k,S,c[N],l[N],u,p);A===null&&T===null?g=N+1:(T===null||u(T,A)>0)&&(T=A)}return x(T!==null?function(){b.continue(T+y)}:C),!1}),O}function De(e,t,r,n){return{type:2,lower:e,upper:t,lowerOpen:r,upperOpen:n}}function li(e){return{type:1,lower:e,upper:e}}var fi=(function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(t,r,n,i){n=n!==!1,i=i===!0;try{return this._cmp(t,r)>0||this._cmp(t,r)===0&&(n||i)&&!(n&&i)?it(this):new this.Collection(this,function(){return De(t,r,!n,!i)})}catch{return ue(this,be)}},e.prototype.equals=function(t){return t==null?ue(this,be):new this.Collection(this,function(){return li(t)})},e.prototype.above=function(t){return t==null?ue(this,be):new this.Collection(this,function(){return De(t,void 0,!0)})},e.prototype.aboveOrEqual=function(t){return t==null?ue(this,be):new this.Collection(this,function(){return De(t,void 0,!1)})},e.prototype.below=function(t){return t==null?ue(this,be):new this.Collection(this,function(){return De(void 0,t,!1,!0)})},e.prototype.belowOrEqual=function(t){return t==null?ue(this,be):new this.Collection(this,function(){return De(void 0,t)})},e.prototype.startsWith=function(t){return typeof t!="string"?ue(this,ei):this.between(t,t+je,!0,!0)},e.prototype.startsWithIgnoreCase=function(t){return t===""?this.startsWith(t):Zt(this,function(r,n){return r.indexOf(n[0])===0},[t],je)},e.prototype.equalsIgnoreCase=function(t){return Zt(this,function(r,n){return r===n[0]},[t],"")},e.prototype.anyOfIgnoreCase=function(){var t=we.apply(Qe,arguments);return t.length===0?it(this):Zt(this,function(r,n){return n.indexOf(r)!==-1},t,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var t=we.apply(Qe,arguments);return t.length===0?it(this):Zt(this,function(r,n){return n.some(function(i){return r.indexOf(i)===0})},t,je)},e.prototype.anyOf=function(){var t=this,r=we.apply(Qe,arguments),n=this._cmp;try{r.sort(n)}catch{return ue(this,be)}if(r.length===0)return it(this);var i=new this.Collection(this,function(){return De(r[0],r[r.length-1])});i._ondirectionchange=function(u){n=u==="next"?t._ascending:t._descending,r.sort(n)};var o=0;return i._addAlgorithm(function(u,c,l){for(var p=u.key;n(p,r[o])>0;)if(++o,o===r.length)return c(l),!1;return n(p,r[o])===0?!0:(c(function(){u.continue(r[o])}),!1)}),i},e.prototype.notEqual=function(t){return this.inAnyRange([[qr,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var t=we.apply(Qe,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return ue(this,be)}var r=t.reduce(function(n,i){return n?n.concat([[n[n.length-1][1],i]]):[[qr,i]]},null);return r.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(r,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(t,r){var n=this,i=this._cmp,o=this._ascending,u=this._descending,c=this._min,l=this._max;if(t.length===0)return it(this);if(!t.every(function(N){return N[0]!==void 0&&N[1]!==void 0&&o(N[0],N[1])<=0}))return ue(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",F.InvalidArgument);var p=!r||r.includeLowers!==!1,y=r&&r.includeUppers===!0;function m(N,A){for(var M=0,I=N.length;M<I;++M){var V=N[M];if(i(A[0],V[1])<0&&i(A[1],V[0])>0){V[0]=c(V[0],A[0]),V[1]=l(V[1],A[1]);break}}return M===I&&N.push(A),N}var R=o;function O(N,A){return R(N[0],A[0])}var g;try{g=t.reduce(m,[]),g.sort(O)}catch{return ue(this,be)}var b=0,x=y?function(N){return o(N,g[b][1])>0}:function(N){return o(N,g[b][1])>=0},C=p?function(N){return u(N,g[b][0])>0}:function(N){return u(N,g[b][0])>=0};function k(N){return!x(N)&&!C(N)}var S=x,T=new this.Collection(this,function(){return De(g[0][0],g[g.length-1][1],!p,!y)});return T._ondirectionchange=function(N){N==="next"?(S=x,R=o):(S=C,R=u),g.sort(O)},T._addAlgorithm(function(N,A,M){for(var I=N.key;S(I);)if(++b,b===g.length)return A(M),!1;return k(I)?!0:(n._cmp(I,g[b][1])===0||n._cmp(I,g[b][0])===0||A(function(){R===o?N.continue(g[b][0]):N.continue(g[b][1])}),!1)}),T},e.prototype.startsWithAnyOf=function(){var t=we.apply(Qe,arguments);return t.every(function(r){return typeof r=="string"})?t.length===0?it(this):this.inAnyRange(t.map(function(r){return[r,r+je]})):ue(this,"startsWithAnyOf() only works with strings")},e})();function $o(e){return mt(fi.prototype,function(r,n,i){if(this.db=e,this._ctx={table:r,index:n===":id"?null:n,or:i},this._cmp=this._ascending=G,this._descending=function(o,u){return G(u,o)},this._max=function(o,u){return G(o,u)>0?o:u},this._min=function(o,u){return G(o,u)<0?o:u},this._IDBKeyRange=e._deps.IDBKeyRange,!this._IDBKeyRange)throw new F.MissingAPI})}function me(e){return Q(function(t){return gt(t),e(t.target.error),!1})}function gt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var yt="storagemutated",zr="x-storagemutated-1",Oe=dt(null,yt),Fo=(function(){function e(){}return e.prototype._lock=function(){return st(!U.global),++this._reculock,this._reculock===1&&!U.global&&(U.lockOwnerFor=this),this},e.prototype._unlock=function(){if(st(!U.global),--this._reculock===0)for(U.global||(U.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{qe(t[1],t[0])}catch{}}return this},e.prototype._locked=function(){return this._reculock&&U.lockOwnerFor!==this},e.prototype.create=function(t){var r=this;if(!this.mode)return this;var n=this.db.idbdb,i=this.db._state.dbOpenError;if(st(!this.idbtrans),!t&&!n)switch(i&&i.name){case"DatabaseClosedError":throw new F.DatabaseClosed(i);case"MissingAPIError":throw new F.MissingAPI(i.message,i);default:throw new F.OpenFailed(i)}if(!this.active)throw new F.TransactionInactive;return st(this._completion._state===null),t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),t.onerror=Q(function(o){gt(o),r._reject(t.error)}),t.onabort=Q(function(o){gt(o),r.active&&r._reject(new F.Abort(t.error)),r.active=!1,r.on("abort").fire(o)}),t.oncomplete=Q(function(){r.active=!1,r._resolve(),"mutatedParts"in t&&Oe.storagemutated.fire(t.mutatedParts)}),this},e.prototype._promise=function(t,r,n){var i=this;if(t==="readwrite"&&this.mode!=="readwrite")return ee(new F.ReadOnly("Transaction is readonly"));if(!this.active)return ee(new F.TransactionInactive);if(this._locked())return new K(function(u,c){i._blockedFuncs.push([function(){i._promise(t,r,n).then(u,c)},U])});if(n)return ke(function(){var u=new K(function(c,l){i._lock();var p=r(c,l,i);p&&p.then&&p.then(c,l)});return u.finally(function(){return i._unlock()}),u._lib=!0,u});var o=new K(function(u,c){var l=r(u,c,i);l&&l.then&&l.then(u,c)});return o._lib=!0,o},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(t){var r=this._root(),n=K.resolve(t);if(r._waitingFor)r._waitingFor=r._waitingFor.then(function(){return n});else{r._waitingFor=n,r._waitingQueue=[];var i=r.idbtrans.objectStore(r.storeNames[0]);(function u(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(i.get(-1/0).onsuccess=u)})()}var o=r._waitingFor;return new K(function(u,c){n.then(function(l){return r._waitingQueue.push(Q(u.bind(null,l)))},function(l){return r._waitingQueue.push(Q(c.bind(null,l)))}).finally(function(){r._waitingFor===o&&(r._waitingFor=null)})})},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new F.Abort))},e.prototype.table=function(t){var r=this._memoizedTables||(this._memoizedTables={});if(X(r,t))return r[t];var n=this.schema[t];if(!n)throw new F.NotFound("Table "+t+" not part of transaction");var i=new this.db.Table(t,n,this);return i.core=this.db.core.table(t),r[t]=i,i},e})();function Vo(e){return mt(Fo.prototype,function(r,n,i,o,u){var c=this;r!=="readonly"&&n.forEach(function(l){var p,y=(p=i[l])===null||p===void 0?void 0:p.yProps;y&&(n=n.concat(y.map(function(m){return m.updatesTable})))}),this.db=e,this.mode=r,this.storeNames=n,this.schema=i,this.chromeTransactionDurability=o,this.idbtrans=null,this.on=dt(this,"complete","error","abort"),this.parent=u||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new K(function(l,p){c._resolve=l,c._reject=p}),this._completion.then(function(){c.active=!1,c.on.complete.fire()},function(l){var p=c.active;return c.active=!1,c.on.error.fire(l),c.parent?c.parent._reject(l):p&&c.idbtrans&&c.idbtrans.abort(),ee(l)})})}function Yr(e,t,r,n,i,o,u,c){return{name:e,keyPath:t,unique:r,multi:n,auto:i,compound:o,src:(r&&!u?"&":"")+(n?"*":"")+(i?"++":"")+hi(t),type:c}}function hi(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function Qr(e,t,r){return{name:e,primKey:t,indexes:r,mappedClass:null,idxByName:eo(r,function(n){return[n.name,n]})}}function qo(e){return e.length===1?e[0]:e}var vt=function(e){try{return e.only([[]]),vt=function(){return[[]]},[[]]}catch{return vt=function(){return je},je}};function Xr(e){return e==null?function(){}:typeof e=="string"?jo(e):function(t){return ve(t,e)}}function jo(e){var t=e.split(".");return t.length===1?function(r){return r[e]}:function(r){return ve(r,e)}}function pi(e){return[].slice.call(e)}var Wo=0;function wt(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function Ho(e,t,r){function n(m,R){var O=pi(m.objectStoreNames);return{schema:{name:m.name,tables:O.map(function(g){return R.objectStore(g)}).map(function(g){var b=g.keyPath,x=g.autoIncrement,C=w(b),k=b==null,S={},T={name:g.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:k,compound:C,keyPath:b,autoIncrement:x,unique:!0,extractKey:Xr(b)},indexes:pi(g.indexNames).map(function(N){return g.index(N)}).map(function(N){var A=N.name,M=N.unique,I=N.multiEntry,V=N.keyPath,W=w(V),L={name:A,compound:W,keyPath:V,unique:M,multiEntry:I,extractKey:Xr(V)};return S[wt(V)]=L,L}),getIndexByKeyPath:function(N){return S[wt(N)]}};return S[":id"]=T.primaryKey,b!=null&&(S[wt(b)]=T.primaryKey),T})},hasGetAll:O.length>0&&"getAll"in R.objectStore(O[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(m){if(m.type===3)return null;if(m.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var R=m.lower,O=m.upper,g=m.lowerOpen,b=m.upperOpen,x=R===void 0?O===void 0?null:t.upperBound(O,!!b):O===void 0?t.lowerBound(R,!!g):t.bound(R,O,!!g,!!b);return x}function o(m){var R=m.name;function O(x){var C=x.trans,k=x.type,S=x.keys,T=x.values,N=x.range;return new Promise(function(A,M){A=Q(A);var I=C.objectStore(R),V=I.keyPath==null,W=k==="put"||k==="add";if(!W&&k!=="delete"&&k!=="deleteRange")throw new Error("Invalid operation type: "+k);var L=(S||T||{length:1}).length;if(S&&T&&S.length!==T.length)throw new Error("Given keys array must have same length as given values array.");if(L===0)return A({numFailures:0,failures:{},results:[],lastResult:void 0});var j,q=[],z=[],B=0,Z=function(ye){++B,gt(ye)};if(k==="deleteRange"){if(N.type===4)return A({numFailures:B,failures:z,results:[],lastResult:void 0});N.type===3?q.push(j=I.clear()):q.push(j=I.delete(i(N)))}else{var ie=W?V?[T,S]:[T,null]:[S,null],ge=ie[0],ae=ie[1];if(W)for(var ce=0;ce<L;++ce)q.push(j=ae&&ae[ce]!==void 0?I[k](ge[ce],ae[ce]):I[k](ge[ce])),j.onerror=Z;else for(var ce=0;ce<L;++ce)q.push(j=I[k](ge[ce])),j.onerror=Z}var Ie=function(ye){var Et=ye.target.result;q.forEach(function(he,fr){return he.error!=null&&(z[fr]=he.error)}),A({numFailures:B,failures:z,results:k==="delete"?S:q.map(function(he){return he.result}),lastResult:Et})};j.onerror=function(ye){Z(ye),Ie(ye)},j.onsuccess=Ie})}function g(x){var C=x.trans,k=x.values,S=x.query,T=x.reverse,N=x.unique;return new Promise(function(A,M){A=Q(A);var I=S.index,V=S.range,W=C.objectStore(R),L=I.isPrimaryKey?W:W.index(I.name),j=T?N?"prevunique":"prev":N?"nextunique":"next",q=k||!("openKeyCursor"in L)?L.openCursor(i(V),j):L.openKeyCursor(i(V),j);q.onerror=me(M),q.onsuccess=Q(function(z){var B=q.result;if(!B){A(null);return}B.___id=++Wo,B.done=!1;var Z=B.continue.bind(B),ie=B.continuePrimaryKey;ie&&(ie=ie.bind(B));var ge=B.advance.bind(B),ae=function(){throw new Error("Cursor not started")},ce=function(){throw new Error("Cursor not stopped")};B.trans=C,B.stop=B.continue=B.continuePrimaryKey=B.advance=ae,B.fail=Q(M),B.next=function(){var Ie=this,ye=1;return this.start(function(){return ye--?Ie.continue():Ie.stop()}).then(function(){return Ie})},B.start=function(Ie){var ye=new Promise(function(he,fr){he=Q(he),q.onerror=me(fr),B.fail=fr,B.stop=function(Pa){B.stop=B.continue=B.continuePrimaryKey=B.advance=ce,he(Pa)}}),Et=function(){if(q.result)try{Ie()}catch(he){B.fail(he)}else B.done=!0,B.start=function(){throw new Error("Cursor behind last entry")},B.stop()};return q.onsuccess=Q(function(he){q.onsuccess=Et,Et()}),B.continue=Z,B.continuePrimaryKey=ie,B.advance=ge,Et(),ye},A(B)},M)})}function b(x){return function(C){return new Promise(function(k,S){k=Q(k);var T=C.trans,N=C.values,A=C.limit,M=C.query,I=A===1/0?void 0:A,V=M.index,W=M.range,L=T.objectStore(R),j=V.isPrimaryKey?L:L.index(V.name),q=i(W);if(A===0)return k({result:[]});if(x){var z=N?j.getAll(q,I):j.getAllKeys(q,I);z.onsuccess=function(ge){return k({result:ge.target.result})},z.onerror=me(S)}else{var B=0,Z=N||!("openKeyCursor"in j)?j.openCursor(q):j.openKeyCursor(q),ie=[];Z.onsuccess=function(ge){var ae=Z.result;if(!ae)return k({result:ie});if(ie.push(N?ae.value:ae.primaryKey),++B===A)return k({result:ie});ae.continue()},Z.onerror=me(S)}})}}return{name:R,schema:m,mutate:O,getMany:function(x){var C=x.trans,k=x.keys;return new Promise(function(S,T){S=Q(S);for(var N=C.objectStore(R),A=k.length,M=new Array(A),I=0,V=0,W,L=function(B){var Z=B.target;(M[Z._pos]=Z.result)!=null,++V===I&&S(M)},j=me(T),q=0;q<A;++q){var z=k[q];z!=null&&(W=N.get(k[q]),W._pos=q,W.onsuccess=L,W.onerror=j,++I)}I===0&&S(M)})},get:function(x){var C=x.trans,k=x.key;return new Promise(function(S,T){S=Q(S);var N=C.objectStore(R),A=N.get(k);A.onsuccess=function(M){return S(M.target.result)},A.onerror=me(T)})},query:b(l),openCursor:g,count:function(x){var C=x.query,k=x.trans,S=C.index,T=C.range;return new Promise(function(N,A){var M=k.objectStore(R),I=S.isPrimaryKey?M:M.index(S.name),V=i(T),W=V?I.count(V):I.count();W.onsuccess=Q(function(L){return N(L.target.result)}),W.onerror=me(A)})}}}var u=n(e,r),c=u.schema,l=u.hasGetAll,p=c.tables.map(function(m){return o(m)}),y={};return p.forEach(function(m){return y[m.name]=m}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(m){var R=y[m];if(!R)throw new Error("Table '".concat(m,"' not found"));return y[m]},MIN_KEY:-1/0,MAX_KEY:vt(t),schema:c}}function Go(e,t){return t.reduce(function(r,n){var i=n.create;return s(s({},r),i(r))},e)}function zo(e,t,r,n){var i=r.IDBKeyRange;r.indexedDB;var o=Go(Ho(t,i,n),e.dbcore);return{dbcore:o}}function er(e,t){var r=t.db,n=zo(e._middlewares,r,e._deps,t);e.core=n.dbcore,e.tables.forEach(function(i){var o=i.name;e.core.schema.tables.some(function(u){return u.name===o})&&(i.core=e.core.table(o),e[o]instanceof e.Table&&(e[o].core=i.core))})}function tr(e,t,r,n){r.forEach(function(i){var o=n[i];t.forEach(function(u){var c=In(u,i);(!c||"value"in c&&c.value===void 0)&&(u===e.Transaction.prototype||u instanceof e.Transaction?fe(u,i,{get:function(){return this.table(i)},set:function(l){Ce(this,i,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):u[i]=new e.Table(i,o))})})}function Jr(e,t){t.forEach(function(r){for(var n in r)r[n]instanceof e.Table&&delete r[n]})}function Yo(e,t){return e._cfg.version-t._cfg.version}function Qo(e,t,r,n){var i=e._dbSchema;r.objectStoreNames.contains("$meta")&&!i.$meta&&(i.$meta=Qr("$meta",mi("")[0],[]),e._storeNames.push("$meta"));var o=e._createTransaction("readwrite",e._storeNames,i);o.create(r),o._completion.catch(n);var u=o._reject.bind(o),c=U.transless||U;ke(function(){if(U.trans=o,U.transless=c,t===0)v(i).forEach(function(l){en(r,l,i[l].primKey,i[l].indexes)}),er(e,r),K.follow(function(){return e.on.populate.fire(o)}).catch(u);else return er(e,r),Jo(e,o,t).then(function(l){return Zo(e,l,o,r)}).catch(u)})}function Xo(e,t){di(e._dbSchema,t),t.db.version%10===0&&!t.objectStoreNames.contains("$meta")&&t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var r=nr(e,e.idbdb,t);ir(e,e._dbSchema,t);for(var n=Zr(r,e._dbSchema),i=function(p){if(p.change.length||p.recreate)return console.warn("Unable to patch indexes of table ".concat(p.name," because it has changes on the type of index or primary key.")),{value:void 0};var y=t.objectStore(p.name);p.add.forEach(function(m){de&&console.debug("Dexie upgrade patch: Creating missing index ".concat(p.name,".").concat(m.src)),rr(y,m)})},o=0,u=n.change;o<u.length;o++){var c=u[o],l=i(c);if(typeof l=="object")return l.value}}function Jo(e,t,r){return t.storeNames.includes("$meta")?t.table("$meta").get("version").then(function(n){return n??r}):K.resolve(r)}function Zo(e,t,r,n){var i=[],o=e._versions,u=e._dbSchema=nr(e,e.idbdb,n),c=o.filter(function(p){return p._cfg.version>=t});if(c.length===0)return K.resolve();c.forEach(function(p){i.push(function(){var y=u,m=p._cfg.dbschema;ir(e,y,n),ir(e,m,n),u=e._dbSchema=m;var R=Zr(y,m);R.add.forEach(function(k){en(n,k[0],k[1].primKey,k[1].indexes)}),R.change.forEach(function(k){if(k.recreate)throw new F.Upgrade("Not yet support for changing primary key");var S=n.objectStore(k.name);k.add.forEach(function(T){return rr(S,T)}),k.change.forEach(function(T){S.deleteIndex(T.name),rr(S,T)}),k.del.forEach(function(T){return S.deleteIndex(T)})});var O=p._cfg.contentUpgrade;if(O&&p._cfg.version>t){er(e,n),r._memoizedTables={};var g=Ln(m);R.del.forEach(function(k){g[k]=y[k]}),Jr(e,[e.Transaction.prototype]),tr(e,[e.Transaction.prototype],v(g),g),r.schema=g;var b=Tr(O);b&&tt();var x,C=K.follow(function(){if(x=O(r),x&&b){var k=Se.bind(null,null);x.then(k,k)}});return x&&typeof x.then=="function"?K.resolve(x):C.then(function(){return x})}}),i.push(function(y){var m=p._cfg.dbschema;ea(m,y),Jr(e,[e.Transaction.prototype]),tr(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),r.schema=e._dbSchema}),i.push(function(y){e.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(e.idbdb.version/10)===p._cfg.version?(e.idbdb.deleteObjectStore("$meta"),delete e._dbSchema.$meta,e._storeNames=e._storeNames.filter(function(m){return m!=="$meta"})):y.objectStore("$meta").put(p._cfg.version,"version"))})});function l(){return i.length?K.resolve(i.shift()(r.idbtrans)).then(l):K.resolve()}return l().then(function(){di(u,n)})}function Zr(e,t){var r={del:[],add:[],change:[]},n;for(n in e)t[n]||r.del.push(n);for(n in t){var i=e[n],o=t[n];if(!i)r.add.push([n,o]);else{var u={name:n,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||i.primKey.auto!==o.primKey.auto)u.recreate=!0,r.change.push(u);else{var c=i.idxByName,l=o.idxByName,p=void 0;for(p in c)l[p]||u.del.push(p);for(p in l){var y=c[p],m=l[p];y?y.src!==m.src&&u.change.push(m):u.add.push(m)}(u.del.length>0||u.add.length>0||u.change.length>0)&&r.change.push(u)}}}return r}function en(e,t,r,n){var i=e.db.createObjectStore(t,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return n.forEach(function(o){return rr(i,o)}),i}function di(e,t){v(e).forEach(function(r){t.db.objectStoreNames.contains(r)||(de&&console.debug("Dexie: Creating missing table",r),en(t,r,e[r].primKey,e[r].indexes))})}function ea(e,t){[].slice.call(t.db.objectStoreNames).forEach(function(r){return e[r]==null&&t.db.deleteObjectStore(r)})}function rr(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function nr(e,t,r){var n={},i=Lt(t.objectStoreNames,0);return i.forEach(function(o){for(var u=r.objectStore(o),c=u.keyPath,l=Yr(hi(c),c||"",!0,!1,!!u.autoIncrement,c&&typeof c!="string",!0),p=[],y=0;y<u.indexNames.length;++y){var m=u.index(u.indexNames[y]);c=m.keyPath;var R=Yr(m.name,c,!!m.unique,!!m.multiEntry,!1,c&&typeof c!="string",!1);p.push(R)}n[o]=Qr(o,l,p)}),n}function ta(e,t,r){e.verno=t.version/10;var n=e._dbSchema=nr(e,t,r);e._storeNames=Lt(t.objectStoreNames,0),tr(e,[e._allTables],v(n),n)}function ra(e,t){var r=nr(e,e.idbdb,t),n=Zr(r,e._dbSchema);return!(n.add.length||n.change.some(function(i){return i.add.length||i.change.length}))}function ir(e,t,r){for(var n=r.db.objectStoreNames,i=0;i<n.length;++i){var o=n[i],u=r.objectStore(o);e._hasGetAll="getAll"in u;for(var c=0;c<u.indexNames.length;++c){var l=u.indexNames[c],p=u.index(l).keyPath,y=typeof p=="string"?p:"["+Lt(p).join("+")+"]";if(t[o]){var m=t[o].idxByName[y];m&&(m.name=l,delete t[o].idxByName[y],t[o].idxByName[l]=m)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&d.WorkerGlobalScope&&d instanceof d.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function mi(e){return e.split(",").map(function(t,r){var n,i=t.split(":"),o=(n=i[1])===null||n===void 0?void 0:n.trim();t=i[0].trim();var u=t.replace(/([&*]|\+\+)/g,""),c=/^\[/.test(u)?u.match(/^\[(.*)\]$/)[1].split("+"):u;return Yr(u,c||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),w(c),r===0,o)})}var na=(function(){function e(){}return e.prototype._createTableSchema=function(t,r,n){return Qr(t,r,n)},e.prototype._parseIndexSyntax=function(t){return mi(t)},e.prototype._parseStoresSpec=function(t,r){var n=this;v(t).forEach(function(i){if(t[i]!==null){var o=n._parseIndexSyntax(t[i]),u=o.shift();if(!u)throw new F.Schema("Invalid schema for table "+i+": "+t[i]);if(u.unique=!0,u.multi)throw new F.Schema("Primary key cannot be multiEntry*");o.forEach(function(l){if(l.auto)throw new F.Schema("Only primary key can be marked as autoIncrement (++)");if(!l.keyPath)throw new F.Schema("Index must have a name and cannot be an empty string")});var c=n._createTableSchema(i,u,o);r[i]=c}})},e.prototype.stores=function(t){var r=this.db;this._cfg.storesSource=this._cfg.storesSource?D(this._cfg.storesSource,t):t;var n=r._versions,i={},o={};return n.forEach(function(u){D(i,u._cfg.storesSource),o=u._cfg.dbschema={},u._parseStoresSpec(i,o)}),r._dbSchema=o,Jr(r,[r._allTables,r,r.Transaction.prototype]),tr(r,[r._allTables,r,r.Transaction.prototype,this._cfg.tables],v(o),o),r._storeNames=v(o),this},e.prototype.upgrade=function(t){return this._cfg.contentUpgrade=Ar(this._cfg.contentUpgrade||Y,t),this},e})();function ia(e){return mt(na.prototype,function(r){this.db=e,this._cfg={version:r,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function tn(e,t){var r=e._dbNamesDB;return r||(r=e._dbNamesDB=new _e(zt,{addons:[],indexedDB:e,IDBKeyRange:t}),r.version(1).stores({dbnames:"name"})),r.table("dbnames")}function rn(e){return e&&typeof e.databases=="function"}function oa(e){var t=e.indexedDB,r=e.IDBKeyRange;return rn(t)?Promise.resolve(t.databases()).then(function(n){return n.map(function(i){return i.name}).filter(function(i){return i!==zt})}):tn(t,r).toCollection().primaryKeys()}function aa(e,t){var r=e.indexedDB,n=e.IDBKeyRange;!rn(r)&&t!==zt&&tn(r,n).put({name:t}).catch(Y)}function sa(e,t){var r=e.indexedDB,n=e.IDBKeyRange;!rn(r)&&t!==zt&&tn(r,n).delete(t).catch(Y)}function nn(e){return ke(function(){return U.letThrough=!0,e()})}function ua(){var e=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!e||!indexedDB.databases)return Promise.resolve();var t;return new Promise(function(r){var n=function(){return indexedDB.databases().finally(r)};t=setInterval(n,100),n()}).finally(function(){return clearInterval(t)})}var on;function an(e){return!("from"in e)}var ne=function(e,t){if(this)D(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0});else{var r=new ne;return e&&"d"in e&&D(r,e),r}};re(ne.prototype,(on={add:function(e){return _t(this,e),this},addKey:function(e){return bt(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(r){return bt(t,r,r)}),this},hasKey:function(e){var t=or(this).next(e).value;return t&&G(t.from,e)<=0&&G(t.to,e)>=0}},on[Sr]=function(){return or(this)},on));function bt(e,t,r){var n=G(t,r);if(!isNaN(n)){if(n>0)throw RangeError();if(an(e))return D(e,{from:t,to:r,d:1});var i=e.l,o=e.r;if(G(r,e.from)<0)return i?bt(i,t,r):e.l={from:t,to:r,d:1,l:null,r:null},yi(e);if(G(t,e.to)>0)return o?bt(o,t,r):e.r={from:t,to:r,d:1,l:null,r:null},yi(e);G(t,e.from)<0&&(e.from=t,e.l=null,e.d=o?o.d+1:1),G(r,e.to)>0&&(e.to=r,e.r=null,e.d=e.l?e.l.d+1:1);var u=!e.r;i&&!e.l&&_t(e,i),o&&u&&_t(e,o)}}function _t(e,t){function r(n,i){var o=i.from,u=i.to,c=i.l,l=i.r;bt(n,o,u),c&&r(n,c),l&&r(n,l)}an(t)||r(e,t)}function gi(e,t){var r=or(t),n=r.next();if(n.done)return!1;for(var i=n.value,o=or(e),u=o.next(i.from),c=u.value;!n.done&&!u.done;){if(G(c.from,i.to)<=0&&G(c.to,i.from)>=0)return!0;G(i.from,c.from)<0?i=(n=r.next(c.from)).value:c=(u=o.next(i.from)).value}return!1}function or(e){var t=an(e)?null:{s:0,n:e};return{next:function(r){for(var n=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&G(r,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||G(r,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function yi(e){var t,r,n=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((r=e.l)===null||r===void 0?void 0:r.d)||0),i=n>1?"r":n<-1?"l":"";if(i){var o=i==="r"?"l":"r",u=s({},e),c=e[i];e.from=c.from,e.to=c.to,e[i]=c[i],u[i]=c[o],e[o]=u,u.d=vi(u)}e.d=vi(e)}function vi(e){var t=e.r,r=e.l;return(t?r?Math.max(t.d,r.d):t.d:r?r.d:0)+1}function ar(e,t){return v(t).forEach(function(r){e[r]?_t(e[r],t[r]):e[r]=$n(t[r])}),e}function sn(e,t){return e.all||t.all||Object.keys(e).some(function(r){return t[r]&&gi(t[r],e[r])})}var He={},un={},cn=!1;function sr(e,t){ar(un,e),cn||(cn=!0,setTimeout(function(){cn=!1;var r=un;un={},ln(r,!1)},0))}function ln(e,t){t===void 0&&(t=!1);var r=new Set;if(e.all)for(var n=0,i=Object.values(He);n<i.length;n++){var o=i[n];wi(o,e,r,t)}else for(var u in e){var c=/^idb\:\/\/(.*)\/(.*)\//.exec(u);if(c){var l=c[1],p=c[2],o=He["idb://".concat(l,"/").concat(p)];o&&wi(o,e,r,t)}}r.forEach(function(y){return y()})}function wi(e,t,r,n){for(var i=[],o=0,u=Object.entries(e.queries.query);o<u.length;o++){for(var c=u[o],l=c[0],p=c[1],y=[],m=0,R=p;m<R.length;m++){var O=R[m];sn(t,O.obsSet)?O.subscribers.forEach(function(C){return r.add(C)}):n&&y.push(O)}n&&i.push([l,y])}if(n)for(var g=0,b=i;g<b.length;g++){var x=b[g],l=x[0],y=x[1];e.queries.query[l]=y}}function ca(e){var t=e._state,r=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?ee(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var n=t.openCanceller,i=Math.round(e.verno*10),o=!1;function u(){if(t.openCanceller!==n)throw new F.DatabaseClosed("db.open() was cancelled")}var c=t.dbReadyResolve,l=null,p=!1,y=function(){return new K(function(m,R){if(u(),!r)throw new F.MissingAPI;var O=e.name,g=t.autoSchema||!i?r.open(O):r.open(O,i);if(!g)throw new F.MissingAPI;g.onerror=me(R),g.onblocked=Q(e._fireOnBlocked),g.onupgradeneeded=Q(function(b){if(l=g.transaction,t.autoSchema&&!e._options.allowEmptyDB){g.onerror=gt,l.abort(),g.result.close();var x=r.deleteDatabase(O);x.onsuccess=x.onerror=Q(function(){R(new F.NoSuchDatabase("Database ".concat(O," doesnt exist")))})}else{l.onerror=me(R);var C=b.oldVersion>Math.pow(2,62)?0:b.oldVersion;p=C<1,e.idbdb=g.result,o&&Xo(e,l),Qo(e,C/10,l,R)}},R),g.onsuccess=Q(function(){l=null;var b=e.idbdb=g.result,x=Lt(b.objectStoreNames);if(x.length>0)try{var C=b.transaction(qo(x),"readonly");if(t.autoSchema)ta(e,b,C);else if(ir(e,e._dbSchema,C),!ra(e,C)&&!o)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),b.close(),i=b.version+1,o=!0,m(y());er(e,C)}catch{}rt.push(e),b.onversionchange=Q(function(k){t.vcFired=!0,e.on("versionchange").fire(k)}),b.onclose=Q(function(){e.close({disableAutoOpen:!1})}),p&&aa(e._deps,O),m()},R)}).catch(function(m){switch(m?.name){case"UnknownError":if(t.PR1398_maxLoop>0)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),y();break;case"VersionError":if(i>0)return i=0,y();break}return K.reject(m)})};return K.race([n,(typeof navigator>"u"?K.resolve():ua()).then(y)]).then(function(){return u(),t.onReadyBeingFired=[],K.resolve(nn(function(){return e.on.ready.fire(e.vip)})).then(function m(){if(t.onReadyBeingFired.length>0){var R=t.onReadyBeingFired.reduce(Ar,Y);return t.onReadyBeingFired=[],K.resolve(nn(function(){return R(e.vip)})).then(m)}})}).finally(function(){t.openCanceller===n&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(m){t.dbOpenError=m;try{l&&l.abort()}catch{}return n===t.openCanceller&&e._close(),ee(m)}).finally(function(){t.openComplete=!0,c()}).then(function(){if(p){var m={};e.tables.forEach(function(R){R.schema.indexes.forEach(function(O){O.name&&(m["idb://".concat(e.name,"/").concat(R.name,"/").concat(O.name)]=new ne(-1/0,[[[]]]))}),m["idb://".concat(e.name,"/").concat(R.name,"/")]=m["idb://".concat(e.name,"/").concat(R.name,"/:dels")]=new ne(-1/0,[[[]]])}),Oe(yt).fire(m),ln(m,!0)}return e})}function fn(e){var t=function(u){return e.next(u)},r=function(u){return e.throw(u)},n=o(t),i=o(r);function o(u){return function(c){var l=u(c),p=l.value;return l.done?p:!p||typeof p.then!="function"?w(p)?Promise.all(p).then(n,i):n(p):p.then(n,i)}}return o(t)()}function la(e,t,r){var n=arguments.length;if(n<2)throw new F.InvalidArgument("Too few arguments");for(var i=new Array(n-1);--n;)i[n-1]=arguments[n];r=i.pop();var o=Un(i);return[e,o,r]}function bi(e,t,r,n,i){return K.resolve().then(function(){var o=U.transless||U,u=e._createTransaction(t,r,e._dbSchema,n);u.explicit=!0;var c={trans:u,transless:o};if(n)u.idbtrans=n.idbtrans;else try{u.create(),u.idbtrans._explicit=!0,e._state.PR1398_maxLoop=3}catch(m){return m.name===Or.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return bi(e,t,r,null,i)})):ee(m)}var l=Tr(i);l&&tt();var p,y=K.follow(function(){if(p=i.call(u,u),p)if(l){var m=Se.bind(null,null);p.then(m,m)}else typeof p.next=="function"&&typeof p.throw=="function"&&(p=fn(p))},c);return(p&&typeof p.then=="function"?K.resolve(p).then(function(m){return u.active?m:ee(new F.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):y.then(function(){return p})).then(function(m){return n&&u._resolve(),u._completion.then(function(){return m})}).catch(function(m){return u._reject(m),ee(m)})})}function ur(e,t,r){for(var n=w(e)?e.slice():[e],i=0;i<r;++i)n.push(t);return n}function fa(e){return s(s({},e),{table:function(t){var r=e.table(t),n=r.schema,i={},o=[];function u(b,x,C){var k=wt(b),S=i[k]=i[k]||[],T=b==null?0:typeof b=="string"?1:b.length,N=x>0,A=s(s({},C),{name:N?"".concat(k,"(virtual-from:").concat(C.name,")"):C.name,lowLevelIndex:C,isVirtual:N,keyTail:x,keyLength:T,extractKey:Xr(b),unique:!N&&C.unique});if(S.push(A),A.isPrimaryKey||o.push(A),T>1){var M=T===2?b[0]:b.slice(0,T-1);u(M,x+1,C)}return S.sort(function(I,V){return I.keyTail-V.keyTail}),A}var c=u(n.primaryKey.keyPath,0,n.primaryKey);i[":id"]=[c];for(var l=0,p=n.indexes;l<p.length;l++){var y=p[l];u(y.keyPath,0,y)}function m(b){var x=i[wt(b)];return x&&x[0]}function R(b,x){return{type:b.type===1?2:b.type,lower:ur(b.lower,b.lowerOpen?e.MAX_KEY:e.MIN_KEY,x),lowerOpen:!0,upper:ur(b.upper,b.upperOpen?e.MIN_KEY:e.MAX_KEY,x),upperOpen:!0}}function O(b){var x=b.query.index;return x.isVirtual?s(s({},b),{query:{index:x.lowLevelIndex,range:R(b.query.range,x.keyTail)}}):b}var g=s(s({},r),{schema:s(s({},n),{primaryKey:c,indexes:o,getIndexByKeyPath:m}),count:function(b){return r.count(O(b))},query:function(b){return r.query(O(b))},openCursor:function(b){var x=b.query.index,C=x.keyTail,k=x.isVirtual,S=x.keyLength;if(!k)return r.openCursor(b);function T(N){function A(I){I!=null?N.continue(ur(I,b.reverse?e.MAX_KEY:e.MIN_KEY,C)):b.unique?N.continue(N.key.slice(0,S).concat(b.reverse?e.MIN_KEY:e.MAX_KEY,C)):N.continue()}var M=Object.create(N,{continue:{value:A},continuePrimaryKey:{value:function(I,V){N.continuePrimaryKey(ur(I,e.MAX_KEY,C),V)}},primaryKey:{get:function(){return N.primaryKey}},key:{get:function(){var I=N.key;return S===1?I[0]:I.slice(0,S)}},value:{get:function(){return N.value}}});return M}return r.openCursor(O(b)).then(function(N){return N&&T(N)})}});return g}})}var ha={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:fa};function hn(e,t,r,n){return r=r||{},n=n||"",v(e).forEach(function(i){if(!X(t,i))r[n+i]=void 0;else{var o=e[i],u=t[i];if(typeof o=="object"&&typeof u=="object"&&o&&u){var c=kr(o),l=kr(u);c!==l?r[n+i]=t[i]:c==="Object"?hn(o,u,r,n+i+"."):o!==u&&(r[n+i]=t[i])}else o!==u&&(r[n+i]=t[i])}}),v(t).forEach(function(i){X(e,i)||(r[n+i]=t[i])}),r}function pn(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var pa={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return s(s({},e),{table:function(t){var r=e.table(t),n=r.schema.primaryKey,i=s(s({},r),{mutate:function(o){var u=U.trans,c=u.table(t).hook,l=c.deleting,p=c.creating,y=c.updating;switch(o.type){case"add":if(p.fire===Y)break;return u._promise("readwrite",function(){return m(o)},!0);case"put":if(p.fire===Y&&y.fire===Y)break;return u._promise("readwrite",function(){return m(o)},!0);case"delete":if(l.fire===Y)break;return u._promise("readwrite",function(){return m(o)},!0);case"deleteRange":if(l.fire===Y)break;return u._promise("readwrite",function(){return R(o)},!0)}return r.mutate(o);function m(g){var b=U.trans,x=g.keys||pn(n,g);if(!x)throw new Error("Keys missing");return g=g.type==="add"||g.type==="put"?s(s({},g),{keys:x}):s({},g),g.type!=="delete"&&(g.values=f([],g.values,!0)),g.keys&&(g.keys=f([],g.keys,!0)),da(r,g,x).then(function(C){var k=x.map(function(S,T){var N=C[T],A={onerror:null,onsuccess:null};if(g.type==="delete")l.fire.call(A,S,N,b);else if(g.type==="add"||N===void 0){var M=p.fire.call(A,S,g.values[T],b);S==null&&M!=null&&(S=M,g.keys[T]=S,n.outbound||oe(g.values[T],n.keyPath,S))}else{var I=hn(N,g.values[T]),V=y.fire.call(A,I,S,N,b);if(V){var W=g.values[T];Object.keys(V).forEach(function(L){X(W,L)?W[L]=V[L]:oe(W,L,V[L])})}}return A});return r.mutate(g).then(function(S){for(var T=S.failures,N=S.results,A=S.numFailures,M=S.lastResult,I=0;I<x.length;++I){var V=N?N[I]:x[I],W=k[I];V==null?W.onerror&&W.onerror(T[I]):W.onsuccess&&W.onsuccess(g.type==="put"&&C[I]?g.values[I]:V)}return{failures:T,results:N,numFailures:A,lastResult:M}}).catch(function(S){return k.forEach(function(T){return T.onerror&&T.onerror(S)}),Promise.reject(S)})})}function R(g){return O(g.trans,g.range,1e4)}function O(g,b,x){return r.query({trans:g,values:!1,query:{index:n,range:b},limit:x}).then(function(C){var k=C.result;return m({type:"delete",keys:k,trans:g}).then(function(S){return S.numFailures>0?Promise.reject(S.failures[0]):k.length<x?{failures:[],numFailures:0,lastResult:void 0}:O(g,s(s({},b),{lower:k[k.length-1],lowerOpen:!0}),x)})})}}});return i}})}};function da(e,t,r){return t.type==="add"?Promise.resolve([]):e.getMany({trans:t.trans,keys:r,cache:"immutable"})}function _i(e,t,r){try{if(!t||t.keys.length<e.length)return null;for(var n=[],i=0,o=0;i<t.keys.length&&o<e.length;++i)G(t.keys[i],e[o])===0&&(n.push(r?Le(t.values[i]):t.values[i]),++o);return n.length===e.length?n:null}catch{return null}}var ma={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var r=e.table(t);return s(s({},r),{getMany:function(n){if(!n.cache)return r.getMany(n);var i=_i(n.keys,n.trans._cache,n.cache==="clone");return i?K.resolve(i):r.getMany(n).then(function(o){return n.trans._cache={keys:n.keys,values:n.cache==="clone"?Le(o):o},o})},mutate:function(n){return n.type!=="add"&&(n.trans._cache=null),r.mutate(n)}})}}}};function Ei(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function xi(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":return!1;case"getMany":return!1;case"count":return!1;case"openCursor":return!1}}var ga={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,r=new ne(e.MIN_KEY,e.MAX_KEY);return s(s({},e),{transaction:function(n,i,o){if(U.subscr&&i!=="readonly")throw new F.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(U.querier));return e.transaction(n,i,o)},table:function(n){var i=e.table(n),o=i.schema,u=o.primaryKey,c=o.indexes,l=u.extractKey,p=u.outbound,y=u.autoIncrement&&c.filter(function(g){return g.compound&&g.keyPath.includes(u.keyPath)}),m=s(s({},i),{mutate:function(g){var b,x,C=g.trans,k=g.mutatedParts||(g.mutatedParts={}),S=function(q){var z="idb://".concat(t,"/").concat(n,"/").concat(q);return k[z]||(k[z]=new ne)},T=S(""),N=S(":dels"),A=g.type,M=g.type==="deleteRange"?[g.range]:g.type==="delete"?[g.keys]:g.values.length<50?[pn(u,g).filter(function(q){return q}),g.values]:[],I=M[0],V=M[1],W=g.trans._cache;if(w(I)){T.addKeys(I);var L=A==="delete"||I.length===V.length?_i(I,W):null;L||N.addKeys(I),(L||V)&&ya(S,o,L,V)}else if(I){var j={from:(b=I.lower)!==null&&b!==void 0?b:e.MIN_KEY,to:(x=I.upper)!==null&&x!==void 0?x:e.MAX_KEY};N.add(j),T.add(j)}else T.add(r),N.add(r),o.indexes.forEach(function(q){return S(q.name).add(r)});return i.mutate(g).then(function(q){return I&&(g.type==="add"||g.type==="put")&&(T.addKeys(q.results),y&&y.forEach(function(z){for(var B=g.values.map(function(ae){return z.extractKey(ae)}),Z=z.keyPath.findIndex(function(ae){return ae===u.keyPath}),ie=0,ge=q.results.length;ie<ge;++ie)B[ie][Z]=q.results[ie];S(z.name).addKeys(B)})),C.mutatedParts=ar(C.mutatedParts||{},k),q})}}),R=function(g){var b,x,C=g.query,k=C.index,S=C.range;return[k,new ne((b=S.lower)!==null&&b!==void 0?b:e.MIN_KEY,(x=S.upper)!==null&&x!==void 0?x:e.MAX_KEY)]},O={get:function(g){return[u,new ne(g.key)]},getMany:function(g){return[u,new ne().addKeys(g.keys)]},count:R,query:R,openCursor:R};return v(O).forEach(function(g){m[g]=function(b){var x=U.subscr,C=!!x,k=Ei(U,i)&&xi(g,b),S=k?b.obsSet={}:x;if(C){var T=function(L){var j="idb://".concat(t,"/").concat(n,"/").concat(L);return S[j]||(S[j]=new ne)},N=T(""),A=T(":dels"),M=O[g](b),I=M[0],V=M[1];if(g==="query"&&I.isPrimaryKey&&!b.values?A.add(V):T(I.name||"").add(V),!I.isPrimaryKey)if(g==="count")A.add(r);else{var W=g==="query"&&p&&b.values&&i.query(s(s({},b),{values:!1}));return i[g].apply(this,arguments).then(function(L){if(g==="query"){if(p&&b.values)return W.then(function(B){var Z=B.result;return N.addKeys(Z),L});var j=b.values?L.result.map(l):L.result;b.values?N.addKeys(j):A.addKeys(j)}else if(g==="openCursor"){var q=L,z=b.values;return q&&Object.create(q,{key:{get:function(){return A.addKey(q.primaryKey),q.key}},primaryKey:{get:function(){var B=q.primaryKey;return A.addKey(B),B}},value:{get:function(){return z&&N.addKey(q.primaryKey),q.value}}})}return L})}}return i[g].apply(this,arguments)}}),m}})}};function ya(e,t,r,n){function i(o){var u=e(o.name||"");function c(p){return p!=null?o.extractKey(p):null}var l=function(p){return o.multiEntry&&w(p)?p.forEach(function(y){return u.addKey(y)}):u.addKey(p)};(r||n).forEach(function(p,y){var m=r&&c(r[y]),R=n&&c(n[y]);G(m,R)!==0&&(m!=null&&l(m),R!=null&&l(R))})}t.indexes.forEach(i)}function Ri(e,t,r){if(r.numFailures===0)return t;if(t.type==="deleteRange")return null;var n=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;if(r.numFailures===n)return null;var i=s({},t);return w(i.keys)&&(i.keys=i.keys.filter(function(o,u){return!(u in r.failures)})),"values"in i&&w(i.values)&&(i.values=i.values.filter(function(o,u){return!(u in r.failures)})),i}function va(e,t){return t.lower===void 0?!0:t.lowerOpen?G(e,t.lower)>0:G(e,t.lower)>=0}function wa(e,t){return t.upper===void 0?!0:t.upperOpen?G(e,t.upper)<0:G(e,t.upper)<=0}function dn(e,t){return va(e,t)&&wa(e,t)}function Ci(e,t,r,n,i,o){if(!r||r.length===0)return e;var u=t.query.index,c=u.multiEntry,l=t.query.range,p=n.schema.primaryKey,y=p.extractKey,m=u.extractKey,R=(u.lowLevelIndex||u).extractKey,O=r.reduce(function(g,b){var x=g,C=[];if(b.type==="add"||b.type==="put")for(var k=new ne,S=b.values.length-1;S>=0;--S){var T=b.values[S],N=y(T);if(!k.hasKey(N)){var A=m(T);(c&&w(A)?A.some(function(L){return dn(L,l)}):dn(A,l))&&(k.addKey(N),C.push(T))}}switch(b.type){case"add":{var M=new ne().addKeys(t.values?g.map(function(L){return y(L)}):g);x=g.concat(t.values?C.filter(function(L){var j=y(L);return M.hasKey(j)?!1:(M.addKey(j),!0)}):C.map(function(L){return y(L)}).filter(function(L){return M.hasKey(L)?!1:(M.addKey(L),!0)}));break}case"put":{var I=new ne().addKeys(b.values.map(function(L){return y(L)}));x=g.filter(function(L){return!I.hasKey(t.values?y(L):L)}).concat(t.values?C:C.map(function(L){return y(L)}));break}case"delete":var V=new ne().addKeys(b.keys);x=g.filter(function(L){return!V.hasKey(t.values?y(L):L)});break;case"deleteRange":var W=b.range;x=g.filter(function(L){return!dn(y(L),W)});break}return x},e);return O===e?e:(O.sort(function(g,b){return G(R(g),R(b))||G(y(g),y(b))}),t.limit&&t.limit<1/0&&(O.length>t.limit?O.length=t.limit:e.length===t.limit&&O.length<t.limit&&(i.dirty=!0)),o?Object.freeze(O):O)}function Ni(e,t){return G(e.lower,t.lower)===0&&G(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function ba(e,t,r,n){if(e===void 0)return t!==void 0?-1:0;if(t===void 0)return 1;var i=G(e,t);if(i===0){if(r&&n)return 0;if(r)return 1;if(n)return-1}return i}function _a(e,t,r,n){if(e===void 0)return t!==void 0?1:0;if(t===void 0)return-1;var i=G(e,t);if(i===0){if(r&&n)return 0;if(r)return-1;if(n)return 1}return i}function Ea(e,t){return ba(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&_a(e.upper,t.upper,e.upperOpen,t.upperOpen)>=0}function xa(e,t,r,n){var i=He["idb://".concat(e,"/").concat(t)];if(!i)return[];var o=i.queries[r];if(!o)return[null,!1,i,null];var u=n.query?n.query.index.name:null,c=o[u||""];if(!c)return[null,!1,i,null];switch(r){case"query":var l=c.find(function(m){return m.req.limit===n.limit&&m.req.values===n.values&&Ni(m.req.query.range,n.query.range)});if(l)return[l,!0,i,c];var p=c.find(function(m){var R="limit"in m.req?m.req.limit:1/0;return R>=n.limit&&(n.values?m.req.values:!0)&&Ea(m.req.query.range,n.query.range)});return[p,!1,i,c];case"count":var y=c.find(function(m){return Ni(m.req.query.range,n.query.range)});return[y,!!y,i,c]}}function Ra(e,t,r,n){e.subscribers.add(r),n.addEventListener("abort",function(){e.subscribers.delete(r),e.subscribers.size===0&&Ca(e,t)})}function Ca(e,t){setTimeout(function(){e.subscribers.size===0&&Ue(t,e)},3e3)}var Na={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name,r=s(s({},e),{transaction:function(n,i,o){var u=e.transaction(n,i,o);if(i==="readwrite"){var c=new AbortController,l=c.signal,p=function(y){return function(){if(c.abort(),i==="readwrite"){for(var m=new Set,R=0,O=n;R<O.length;R++){var g=O[R],b=He["idb://".concat(t,"/").concat(g)];if(b){var x=e.table(g),C=b.optimisticOps.filter(function(z){return z.trans===u});if(u._explicit&&y&&u.mutatedParts)for(var k=0,S=Object.values(b.queries.query);k<S.length;k++)for(var T=S[k],N=0,A=T.slice();N<A.length;N++){var M=A[N];sn(M.obsSet,u.mutatedParts)&&(Ue(T,M),M.subscribers.forEach(function(z){return m.add(z)}))}else if(C.length>0){b.optimisticOps=b.optimisticOps.filter(function(z){return z.trans!==u});for(var I=0,V=Object.values(b.queries.query);I<V.length;I++)for(var T=V[I],W=0,L=T.slice();W<L.length;W++){var M=L[W];if(M.res!=null&&u.mutatedParts)if(y&&!M.dirty){var j=Object.isFrozen(M.res),q=Ci(M.res,M.req,C,x,M,j);M.dirty?(Ue(T,M),M.subscribers.forEach(function(Z){return m.add(Z)})):q!==M.res&&(M.res=q,M.promise=K.resolve({result:q}))}else M.dirty&&Ue(T,M),M.subscribers.forEach(function(Z){return m.add(Z)})}}}}m.forEach(function(z){return z()})}}};u.addEventListener("abort",p(!1),{signal:l}),u.addEventListener("error",p(!1),{signal:l}),u.addEventListener("complete",p(!0),{signal:l})}return u},table:function(n){var i=e.table(n),o=i.schema.primaryKey,u=s(s({},i),{mutate:function(c){var l=U.trans;if(o.outbound||l.db._options.cache==="disabled"||l.explicit||l.idbtrans.mode!=="readwrite")return i.mutate(c);var p=He["idb://".concat(t,"/").concat(n)];if(!p)return i.mutate(c);var y=i.mutate(c);return(c.type==="add"||c.type==="put")&&(c.values.length>=50||pn(o,c).some(function(m){return m==null}))?y.then(function(m){var R=s(s({},c),{values:c.values.map(function(g,b){var x;if(m.failures[b])return g;var C=!((x=o.keyPath)===null||x===void 0)&&x.includes(".")?Le(g):s({},g);return oe(C,o.keyPath,m.results[b]),C})}),O=Ri(p,R,m);p.optimisticOps.push(O),queueMicrotask(function(){return c.mutatedParts&&sr(c.mutatedParts)})}):(p.optimisticOps.push(c),c.mutatedParts&&sr(c.mutatedParts),y.then(function(m){if(m.numFailures>0){Ue(p.optimisticOps,c);var R=Ri(p,c,m);R&&p.optimisticOps.push(R),c.mutatedParts&&sr(c.mutatedParts)}}),y.catch(function(){Ue(p.optimisticOps,c),c.mutatedParts&&sr(c.mutatedParts)})),y},query:function(c){var l;if(!Ei(U,i)||!xi("query",c))return i.query(c);var p=((l=U.trans)===null||l===void 0?void 0:l.db._options.cache)==="immutable",y=U,m=y.requery,R=y.signal,O=xa(t,n,"query",c),g=O[0],b=O[1],x=O[2],C=O[3];if(g&&b)g.obsSet=c.obsSet;else{var k=i.query(c).then(function(S){var T=S.result;if(g&&(g.res=T),p){for(var N=0,A=T.length;N<A;++N)Object.freeze(T[N]);Object.freeze(T)}else S.result=Le(T);return S}).catch(function(S){return C&&g&&Ue(C,g),Promise.reject(S)});g={obsSet:c.obsSet,promise:k,subscribers:new Set,type:"query",req:c,dirty:!1},C?C.push(g):(C=[g],x||(x=He["idb://".concat(t,"/").concat(n)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}}),x.queries.query[c.query.index.name||""]=C)}return Ra(g,C,m,R),g.promise.then(function(S){return{result:Ci(S.result,c,x?.optimisticOps,i,g,p)}})}});return u}});return r}};function cr(e,t){return new Proxy(e,{get:function(r,n,i){return n==="db"?t:Reflect.get(r,n,i)}})}var _e=(function(){function e(t,r){var n=this;this._middlewares={},this.verno=0;var i=e.dependencies;this._options=r=s({addons:e.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange,cache:"cloned"},r),this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange};var o=r.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var u={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Y,dbReadyPromise:null,cancelOpen:Y,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:r.autoOpen};u.dbReadyPromise=new K(function(l){u.dbReadyResolve=l}),u.openCanceller=new K(function(l,p){u.cancelOpen=p}),this._state=u,this.name=t,this.on=dt(this,"populate","blocked","versionchange","close",{ready:[Ar,Y]}),this.once=function(l,p){var y=function(){for(var m=[],R=0;R<arguments.length;R++)m[R]=arguments[R];n.on(l).unsubscribe(y),p.apply(n,m)};return n.on(l,y)},this.on.ready.subscribe=Kn(this.on.ready.subscribe,function(l){return function(p,y){e.vip(function(){var m=n._state;if(m.openComplete)m.dbOpenError||K.resolve().then(p),y&&l(p);else if(m.onReadyBeingFired)m.onReadyBeingFired.push(p),y&&l(p);else{l(p);var R=n;y||l(function O(){R.on.ready.unsubscribe(p),R.on.ready.unsubscribe(O)})}})}}),this.Collection=Io(this),this.Table=Oo(this),this.Transaction=Vo(this),this.Version=ia(this),this.WhereClause=$o(this),this.on("versionchange",function(l){l.newVersion>0?console.warn("Another connection wants to upgrade database '".concat(n.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(n.name,"'. Closing db now to resume the delete request.")),n.close({disableAutoOpen:!1})}),this.on("blocked",function(l){!l.newVersion||l.newVersion<l.oldVersion?console.warn("Dexie.delete('".concat(n.name,"') was blocked")):console.warn("Upgrade '".concat(n.name,"' blocked by other connection holding version ").concat(l.oldVersion/10))}),this._maxKey=vt(r.IDBKeyRange),this._createTransaction=function(l,p,y,m){return new n.Transaction(l,p,y,n._options.chromeTransactionDurability,m)},this._fireOnBlocked=function(l){n.on("blocked").fire(l),rt.filter(function(p){return p.name===n.name&&p!==n&&!p._state.vcFired}).map(function(p){return p.on("versionchange").fire(l)})},this.use(ma),this.use(Na),this.use(ga),this.use(ha),this.use(pa);var c=new Proxy(this,{get:function(l,p,y){if(p==="_vip")return!0;if(p==="table")return function(R){return cr(n.table(R),c)};var m=Reflect.get(l,p,y);return m instanceof ai?cr(m,c):p==="tables"?m.map(function(R){return cr(R,c)}):p==="_createTransaction"?function(){var R=m.apply(this,arguments);return cr(R,c)}:m}});this.vip=c,o.forEach(function(l){return l(n)})}return e.prototype.version=function(t){if(isNaN(t)||t<.1)throw new F.Type("Given version is not a positive number");if(t=Math.round(t*10)/10,this.idbdb||this._state.isBeingOpened)throw new F.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var r=this._versions,n=r.filter(function(i){return i._cfg.version===t})[0];return n||(n=new this.Version(t),r.push(n),r.sort(Yo),n.stores({}),this._state.autoSchema=!1,n)},e.prototype._whenReady=function(t){var r=this;return this.idbdb&&(this._state.openComplete||U.letThrough||this._vip)?t():new K(function(n,i){if(r._state.openComplete)return i(new F.DatabaseClosed(r._state.dbOpenError));if(!r._state.isBeingOpened){if(!r._state.autoOpen){i(new F.DatabaseClosed);return}r.open().catch(Y)}r._state.dbReadyPromise.then(n,i)}).then(t)},e.prototype.use=function(t){var r=t.stack,n=t.create,i=t.level,o=t.name;o&&this.unuse({stack:r,name:o});var u=this._middlewares[r]||(this._middlewares[r]=[]);return u.push({stack:r,create:n,level:i??10,name:o}),u.sort(function(c,l){return c.level-l.level}),this},e.prototype.unuse=function(t){var r=t.stack,n=t.name,i=t.create;return r&&this._middlewares[r]&&(this._middlewares[r]=this._middlewares[r].filter(function(o){return i?o.create!==i:n?o.name!==n:!1})),this},e.prototype.open=function(){var t=this;return qe(Ne,function(){return ca(t)})},e.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var t=this._state,r=rt.indexOf(this);if(r>=0&&rt.splice(r,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}t.isBeingOpened||(t.dbReadyPromise=new K(function(n){t.dbReadyResolve=n}),t.openCanceller=new K(function(n,i){t.cancelOpen=i}))},e.prototype.close=function(t){var r=t===void 0?{disableAutoOpen:!0}:t,n=r.disableAutoOpen,i=this._state;n?(i.isBeingOpened&&i.cancelOpen(new F.DatabaseClosed),this._close(),i.autoOpen=!1,i.dbOpenError=new F.DatabaseClosed):(this._close(),i.autoOpen=this._options.autoOpen||i.isBeingOpened,i.openComplete=!1,i.dbOpenError=null)},e.prototype.delete=function(t){var r=this;t===void 0&&(t={disableAutoOpen:!0});var n=arguments.length>0&&typeof arguments[0]!="object",i=this._state;return new K(function(o,u){var c=function(){r.close(t);var l=r._deps.indexedDB.deleteDatabase(r.name);l.onsuccess=Q(function(){sa(r._deps,r.name),o()}),l.onerror=me(u),l.onblocked=r._fireOnBlocked};if(n)throw new F.InvalidArgument("Invalid closeOptions argument to db.delete()");i.isBeingOpened?i.dbReadyPromise.then(c):c()})},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return this.idbdb!==null},e.prototype.hasBeenClosed=function(){var t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"},e.prototype.hasFailed=function(){return this._state.dbOpenError!==null},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var t=this;return v(this._allTables).map(function(r){return t._allTables[r]})},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var t=la.apply(this,arguments);return this._transaction.apply(this,t)},e.prototype._transaction=function(t,r,n){var i=this,o=U.trans;(!o||o.db!==this||t.indexOf("!")!==-1)&&(o=null);var u=t.indexOf("?")!==-1;t=t.replace("!","").replace("?","");var c,l;try{if(l=r.map(function(y){var m=y instanceof i.Table?y.name:y;if(typeof m!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return m}),t=="r"||t===jr)c=jr;else if(t=="rw"||t==Wr)c=Wr;else throw new F.InvalidArgument("Invalid transaction mode: "+t);if(o){if(o.mode===jr&&c===Wr)if(u)o=null;else throw new F.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o&&l.forEach(function(y){if(o&&o.storeNames.indexOf(y)===-1)if(u)o=null;else throw new F.SubTransaction("Table "+y+" not included in parent transaction.")}),u&&o&&!o.active&&(o=null)}}catch(y){return o?o._promise(null,function(m,R){R(y)}):ee(y)}var p=bi.bind(null,this,c,l,o,n);return o?o._promise(c,p,"lock"):U.trans?qe(U.transless,function(){return i._whenReady(p)}):this._whenReady(p)},e.prototype.table=function(t){if(!X(this._allTables,t))throw new F.InvalidTable("Table ".concat(t," does not exist"));return this._allTables[t]},e})(),ka=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Sa=(function(){function e(t){this._subscribe=t}return e.prototype.subscribe=function(t,r,n){return this._subscribe(!t||typeof t=="function"?{next:t,error:r,complete:n}:t)},e.prototype[ka]=function(){return this},e})(),lr;try{lr={indexedDB:d.indexedDB||d.mozIndexedDB||d.webkitIndexedDB||d.msIndexedDB,IDBKeyRange:d.IDBKeyRange||d.webkitIDBKeyRange}}catch{lr={indexedDB:null,IDBKeyRange:null}}function ki(e){var t=!1,r,n=new Sa(function(i){var o=Tr(e);function u(C){var k=Ze();try{o&&tt();var S=ke(e,C);return o&&(S=S.finally(Se)),S}finally{k&&et()}}var c=!1,l,p={},y={},m={get closed(){return c},unsubscribe:function(){c||(c=!0,l&&l.abort(),R&&Oe.storagemutated.unsubscribe(b))}};i.start&&i.start(m);var R=!1,O=function(){return Fr(x)};function g(){return sn(y,p)}var b=function(C){ar(p,C),g()&&O()},x=function(){if(!(c||!lr.indexedDB)){p={};var C={};l&&l.abort(),l=new AbortController;var k={subscr:C,signal:l.signal,requery:O,querier:e,trans:null},S=u(k);Promise.resolve(S).then(function(T){t=!0,r=T,!(c||k.signal.aborted)&&(p={},y=C,!io(y)&&!R&&(Oe(yt,b),R=!0),Fr(function(){return!c&&i.next&&i.next(T)}))},function(T){t=!1,["DatabaseClosedError","AbortError"].includes(T?.name)||c||Fr(function(){c||i.error&&i.error(T)})})}};return setTimeout(O,0),m});return n.hasValue=function(){return t},n.getValue=function(){return r},n}var Ge=_e;re(Ge,s(s({},Bt),{delete:function(e){var t=new Ge(e,{addons:[]});return t.delete()},exists:function(e){return new Ge(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return oa(Ge.dependencies).then(e)}catch{return ee(new F.MissingAPI)}},defineClass:function(){function e(t){D(this,t)}return e},ignoreTransaction:function(e){return U.trans?qe(U.transless,e):e()},vip:nn,async:function(e){return function(){try{var t=fn(e.apply(this,arguments));return!t||typeof t.then!="function"?K.resolve(t):t}catch(r){return ee(r)}}},spawn:function(e,t,r){try{var n=fn(e.apply(r,t||[]));return!n||typeof n.then!="function"?K.resolve(n):n}catch(i){return ee(i)}},currentTransaction:{get:function(){return U.trans||null}},waitFor:function(e,t){var r=K.resolve(typeof e=="function"?Ge.ignoreTransaction(e):e).timeout(t||6e4);return U.trans?U.trans.waitFor(r):r},Promise:K,debug:{get:function(){return de},set:function(e){jn(e)}},derive:Ye,extend:D,props:re,override:Kn,Events:dt,on:Oe,liveQuery:ki,extendObservabilitySet:ar,getByKeyPath:ve,setByKeyPath:oe,delByKeyPath:to,shallowClone:Ln,deepClone:Le,getObjectDiff:hn,cmp:G,asap:Mn,minKey:qr,addons:[],connections:rt,errnames:Or,dependencies:lr,cache:He,semVer:Zn,version:Zn.split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,r){return e+t/Math.pow(10,r*2)})})),Ge.maxKey=vt(Ge.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Oe(yt,function(e){if(!Ae){var t;t=new CustomEvent(zr,{detail:e}),Ae=!0,dispatchEvent(t),Ae=!1}}),addEventListener(zr,function(e){var t=e.detail;Ae||mn(t)}));function mn(e){var t=Ae;try{Ae=!0,Oe.storagemutated.fire(e),ln(e,!0)}finally{Ae=t}}var Ae=!1,Pe,gn=function(){};typeof BroadcastChannel<"u"&&(gn=function(){Pe=new BroadcastChannel(zr),Pe.onmessage=function(e){return e.data&&mn(e.data)}},gn(),typeof Pe.unref=="function"&&Pe.unref(),Oe(yt,function(e){Ae||Pe.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!_e.disableBfCache&&e.persisted){de&&console.debug("Dexie: handling persisted pagehide"),Pe?.close();for(var t=0,r=rt;t<r.length;t++){var n=r[t];n.close({disableAutoOpen:!1})}}}),addEventListener("pageshow",function(e){!_e.disableBfCache&&e.persisted&&(de&&console.debug("Dexie: handling persisted pageshow"),gn(),mn({all:new ne(-1/0,[[]])}))}));function Ta(e){return new pt({add:e})}function Da(e){return new pt({remove:e})}function Oa(e,t){return new pt({replacePrefix:[e,t]})}K.rejectionMapper=lo,jn(de);var Aa=Object.freeze({__proto__:null,Dexie:_e,liveQuery:ki,Entity:ri,cmp:G,PropModification:pt,replacePrefix:Oa,add:Ta,remove:Da,default:_e,RangeSet:ne,mergeRanges:_t,rangesOverlap:gi});return s(_e,Aa,{default:_e}),_e}))});E();E();E();E();E();E();E();E();E();E();try{self["workbox:core:7.3.0"]&&_()}catch{}var Wa=(h,...a)=>{let s=h;return a.length>0&&(s+=` :: ${JSON.stringify(a)}`),s};var Si=Wa;var H=class extends Error{constructor(a,s){let f=Si(a,s);super(f),this.name=a,this.details=s}};E();var Ee={googleAnalytics:"googleAnalytics",precache:"precache-v2",prefix:"workbox",runtime:"runtime",suffix:typeof registration<"u"?registration.scope:""},vn=h=>[Ee.prefix,h,Ee.suffix].filter(a=>a&&a.length>0).join("-"),Ha=h=>{for(let a of Object.keys(Ee))h(a)},xe={updateDetails:h=>{Ha(a=>{typeof h[a]=="string"&&(Ee[a]=h[a])})},getGoogleAnalyticsName:h=>h||vn(Ee.googleAnalytics),getPrecacheName:h=>h||vn(Ee.precache),getPrefix:()=>Ee.prefix,getRuntimeName:h=>h||vn(Ee.runtime),getSuffix:()=>Ee.suffix};E();E();function wn(h,a){let s=a();return h.waitUntil(s),s}E();E();try{self["workbox:precaching:7.3.0"]&&_()}catch{}var Ga="__WB_REVISION__";function Ti(h){if(!h)throw new H("add-to-cache-list-unexpected-type",{entry:h});if(typeof h=="string"){let v=new URL(h,location.href);return{cacheKey:v.href,url:v.href}}let{revision:a,url:s}=h;if(!s)throw new H("add-to-cache-list-unexpected-type",{entry:h});if(!a){let v=new URL(s,location.href);return{cacheKey:v.href,url:v.href}}let f=new URL(s,location.href),d=new URL(s,location.href);return f.searchParams.set(Ga,a),{cacheKey:f.href,url:d.href}}E();var hr=class{constructor(){this.updatedURLs=[],this.notUpdatedURLs=[],this.handlerWillStart=async({request:a,state:s})=>{s&&(s.originalRequest=a)},this.cachedResponseWillBeUsed=async({event:a,state:s,cachedResponse:f})=>{if(a.type==="install"&&s&&s.originalRequest&&s.originalRequest instanceof Request){let d=s.originalRequest.url;f?this.notUpdatedURLs.push(d):this.updatedURLs.push(d)}return f}}};E();var pr=class{constructor({precacheController:a}){this.cacheKeyWillBeUsed=async({request:s,params:f})=>{let d=f?.cacheKey||this._precacheController.getCacheKeyForURL(s.url);return d?new Request(d,{headers:s.headers}):s},this._precacheController=a}};E();E();E();E();E();var xt;function Oi(){if(xt===void 0){let h=new Response("");if("body"in h)try{new Response(h.body),xt=!0}catch{xt=!1}xt=!1}return xt}async function Ai(h,a){let s=null;if(h.url&&(s=new URL(h.url).origin),s!==self.location.origin)throw new H("cross-origin-copy-response",{origin:s});let f=h.clone(),d={headers:new Headers(f.headers),status:f.status,statusText:f.statusText},v=a?a(d):d,w=Oi()?f.body:await f.blob();return new Response(w,v)}E();var bn=h=>new URL(String(h),location.href).href.replace(new RegExp(`^${location.origin}`),"");E();E();E();function Pi(h,a){let s=new URL(h);for(let f of a)s.searchParams.delete(f);return s.href}async function Ii(h,a,s,f){let d=Pi(a.url,s);if(a.url===d)return h.match(a,f);let v=Object.assign(Object.assign({},f),{ignoreSearch:!0}),w=await h.keys(a,v);for(let D of w){let $=Pi(D.url,s);if(d===$)return h.match(D,f)}}E();var dr=class{constructor(){this.promise=new Promise((a,s)=>{this.resolve=a,this.reject=s})}};E();E();var mr=new Set;async function Ki(){for(let h of mr)await h()}E();function gr(h){return new Promise(a=>setTimeout(a,h))}E();try{self["workbox:strategies:7.3.0"]&&_()}catch{}function yr(h){return typeof h=="string"?new Request(h):h}var Rt=class{constructor(a,s){this._cacheKeys={},Object.assign(this,s),this.event=s.event,this._strategy=a,this._handlerDeferred=new dr,this._extendLifetimePromises=[],this._plugins=[...a.plugins],this._pluginStateMap=new Map;for(let f of this._plugins)this._pluginStateMap.set(f,{});this.event.waitUntil(this._handlerDeferred.promise)}async fetch(a){let{event:s}=this,f=yr(a);if(f.mode==="navigate"&&s instanceof FetchEvent&&s.preloadResponse){let w=await s.preloadResponse;if(w)return w}let d=this.hasCallback("fetchDidFail")?f.clone():null;try{for(let w of this.iterateCallbacks("requestWillFetch"))f=await w({request:f.clone(),event:s})}catch(w){if(w instanceof Error)throw new H("plugin-error-request-will-fetch",{thrownErrorMessage:w.message})}let v=f.clone();try{let w;w=await fetch(f,f.mode==="navigate"?void 0:this._strategy.fetchOptions);for(let D of this.iterateCallbacks("fetchDidSucceed"))w=await D({event:s,request:v,response:w});return w}catch(w){throw d&&await this.runCallbacks("fetchDidFail",{error:w,event:s,originalRequest:d.clone(),request:v.clone()}),w}}async fetchAndCachePut(a){let s=await this.fetch(a),f=s.clone();return this.waitUntil(this.cachePut(a,f)),s}async cacheMatch(a){let s=yr(a),f,{cacheName:d,matchOptions:v}=this._strategy,w=await this.getCacheKey(s,"read"),D=Object.assign(Object.assign({},v),{cacheName:d});f=await caches.match(w,D);for(let $ of this.iterateCallbacks("cachedResponseWillBeUsed"))f=await $({cacheName:d,matchOptions:v,cachedResponse:f,request:w,event:this.event})||void 0;return f}async cachePut(a,s){let f=yr(a);await gr(0);let d=await this.getCacheKey(f,"write");if(!s)throw new H("cache-put-with-no-response",{url:bn(d.url)});let v=await this._ensureResponseSafeToCache(s);if(!v)return!1;let{cacheName:w,matchOptions:D}=this._strategy,$=await self.caches.open(w),J=this.hasCallback("cacheDidUpdate"),X=J?await Ii($,d.clone(),["__WB_REVISION__"],D):null;try{await $.put(d,J?v.clone():v)}catch(re){if(re instanceof Error)throw re.name==="QuotaExceededError"&&await Ki(),re}for(let re of this.iterateCallbacks("cacheDidUpdate"))await re({cacheName:w,oldResponse:X,newResponse:v.clone(),request:d,event:this.event});return!0}async getCacheKey(a,s){let f=`${a.url} | ${s}`;if(!this._cacheKeys[f]){let d=a;for(let v of this.iterateCallbacks("cacheKeyWillBeUsed"))d=yr(await v({mode:s,request:d,event:this.event,params:this.params}));this._cacheKeys[f]=d}return this._cacheKeys[f]}hasCallback(a){for(let s of this._strategy.plugins)if(a in s)return!0;return!1}async runCallbacks(a,s){for(let f of this.iterateCallbacks(a))await f(s)}*iterateCallbacks(a){for(let s of this._strategy.plugins)if(typeof s[a]=="function"){let f=this._pluginStateMap.get(s);yield v=>{let w=Object.assign(Object.assign({},v),{state:f});return s[a](w)}}}waitUntil(a){return this._extendLifetimePromises.push(a),a}async doneWaiting(){for(;this._extendLifetimePromises.length;){let a=this._extendLifetimePromises.splice(0),f=(await Promise.allSettled(a)).find(d=>d.status==="rejected");if(f)throw f.reason}}destroy(){this._handlerDeferred.resolve(null)}async _ensureResponseSafeToCache(a){let s=a,f=!1;for(let d of this.iterateCallbacks("cacheWillUpdate"))if(s=await d({request:this.request,response:s,event:this.event})||void 0,f=!0,!s)break;return f||s&&s.status!==200&&(s=void 0),s}};var se=class{constructor(a={}){this.cacheName=xe.getRuntimeName(a.cacheName),this.plugins=a.plugins||[],this.fetchOptions=a.fetchOptions,this.matchOptions=a.matchOptions}handle(a){let[s]=this.handleAll(a);return s}handleAll(a){a instanceof FetchEvent&&(a={event:a,request:a.request});let s=a.event,f=typeof a.request=="string"?new Request(a.request):a.request,d="params"in a?a.params:void 0,v=new Rt(this,{event:s,request:f,params:d}),w=this._getResponse(v,f,s),D=this._awaitComplete(w,v,f,s);return[w,D]}async _getResponse(a,s,f){await a.runCallbacks("handlerWillStart",{event:f,request:s});let d;try{if(d=await this._handle(s,a),!d||d.type==="error")throw new H("no-response",{url:s.url})}catch(v){if(v instanceof Error){for(let w of a.iterateCallbacks("handlerDidError"))if(d=await w({error:v,event:f,request:s}),d)break}if(!d)throw v}for(let v of a.iterateCallbacks("handlerWillRespond"))d=await v({event:f,request:s,response:d});return d}async _awaitComplete(a,s,f,d){let v,w;try{v=await a}catch{}try{await s.runCallbacks("handlerDidRespond",{event:d,request:f,response:v}),await s.doneWaiting()}catch(D){D instanceof Error&&(w=D)}if(await s.runCallbacks("handlerDidComplete",{event:d,request:f,response:v,error:w}),s.destroy(),w)throw w}};var ze=class h extends se{constructor(a={}){a.cacheName=xe.getPrecacheName(a.cacheName),super(a),this._fallbackToNetwork=a.fallbackToNetwork!==!1,this.plugins.push(h.copyRedirectedCacheableResponsesPlugin)}async _handle(a,s){let f=await s.cacheMatch(a);return f||(s.event&&s.event.type==="install"?await this._handleInstall(a,s):await this._handleFetch(a,s))}async _handleFetch(a,s){let f,d=s.params||{};if(this._fallbackToNetwork){let v=d.integrity,w=a.integrity,D=!w||w===v;if(f=await s.fetch(new Request(a,{integrity:a.mode!=="no-cors"?w||v:void 0})),v&&D&&a.mode!=="no-cors"){this._useDefaultCacheabilityPluginIfNeeded();let $=await s.cachePut(a,f.clone())}}else throw new H("missing-precache-entry",{cacheName:this.cacheName,url:a.url});return f}async _handleInstall(a,s){this._useDefaultCacheabilityPluginIfNeeded();let f=await s.fetch(a);if(!await s.cachePut(a,f.clone()))throw new H("bad-precaching-response",{url:a.url,status:f.status});return f}_useDefaultCacheabilityPluginIfNeeded(){let a=null,s=0;for(let[f,d]of this.plugins.entries())d!==h.copyRedirectedCacheableResponsesPlugin&&(d===h.defaultPrecacheCacheabilityPlugin&&(a=f),d.cacheWillUpdate&&s++);s===0?this.plugins.push(h.defaultPrecacheCacheabilityPlugin):s>1&&a!==null&&this.plugins.splice(a,1)}};ze.defaultPrecacheCacheabilityPlugin={async cacheWillUpdate({response:h}){return!h||h.status>=400?null:h}};ze.copyRedirectedCacheableResponsesPlugin={async cacheWillUpdate({response:h}){return h.redirected?await Ai(h):h}};var Ct=class{constructor({cacheName:a,plugins:s=[],fallbackToNetwork:f=!0}={}){this._urlsToCacheKeys=new Map,this._urlsToCacheModes=new Map,this._cacheKeysToIntegrities=new Map,this._strategy=new ze({cacheName:xe.getPrecacheName(a),plugins:[...s,new pr({precacheController:this})],fallbackToNetwork:f}),this.install=this.install.bind(this),this.activate=this.activate.bind(this)}get strategy(){return this._strategy}precache(a){this.addToCacheList(a),this._installAndActiveListenersAdded||(self.addEventListener("install",this.install),self.addEventListener("activate",this.activate),this._installAndActiveListenersAdded=!0)}addToCacheList(a){let s=[];for(let f of a){typeof f=="string"?s.push(f):f&&f.revision===void 0&&s.push(f.url);let{cacheKey:d,url:v}=Ti(f),w=typeof f!="string"&&f.revision?"reload":"default";if(this._urlsToCacheKeys.has(v)&&this._urlsToCacheKeys.get(v)!==d)throw new H("add-to-cache-list-conflicting-entries",{firstEntry:this._urlsToCacheKeys.get(v),secondEntry:d});if(typeof f!="string"&&f.integrity){if(this._cacheKeysToIntegrities.has(d)&&this._cacheKeysToIntegrities.get(d)!==f.integrity)throw new H("add-to-cache-list-conflicting-integrities",{url:v});this._cacheKeysToIntegrities.set(d,f.integrity)}if(this._urlsToCacheKeys.set(v,d),this._urlsToCacheModes.set(v,w),s.length>0){let D=`Workbox is precaching URLs without revision info: ${s.join(", ")}
This is generally NOT safe. Learn more at https://bit.ly/wb-precache`;console.warn(D)}}}install(a){return wn(a,async()=>{let s=new hr;this.strategy.plugins.push(s);for(let[v,w]of this._urlsToCacheKeys){let D=this._cacheKeysToIntegrities.get(w),$=this._urlsToCacheModes.get(v),J=new Request(v,{integrity:D,cache:$,credentials:"same-origin"});await Promise.all(this.strategy.handleAll({params:{cacheKey:w},request:J,event:a}))}let{updatedURLs:f,notUpdatedURLs:d}=s;return{updatedURLs:f,notUpdatedURLs:d}})}activate(a){return wn(a,async()=>{let s=await self.caches.open(this.strategy.cacheName),f=await s.keys(),d=new Set(this._urlsToCacheKeys.values()),v=[];for(let w of f)d.has(w.url)||(await s.delete(w),v.push(w.url));return{deletedURLs:v}})}getURLsToCacheKeys(){return this._urlsToCacheKeys}getCachedURLs(){return[...this._urlsToCacheKeys.keys()]}getCacheKeyForURL(a){let s=new URL(a,location.href);return this._urlsToCacheKeys.get(s.href)}getIntegrityForCacheKey(a){return this._cacheKeysToIntegrities.get(a)}async matchPrecache(a){let s=a instanceof Request?a.url:a,f=this.getCacheKeyForURL(s);if(f)return(await self.caches.open(this.strategy.cacheName)).match(f)}createHandlerBoundToURL(a){let s=this.getCacheKeyForURL(a);if(!s)throw new H("non-precached-url",{url:a});return f=>(f.request=new Request(a),f.params=Object.assign({cacheKey:s},f.params),this.strategy.handle(f))}};var _n,Re=()=>(_n||(_n=new Ct),_n);E();E();E();E();E();try{self["workbox:routing:7.3.0"]&&_()}catch{}var vr="GET";E();var ot=h=>h&&typeof h=="object"?h:{handle:h};var le=class{constructor(a,s,f=vr){this.handler=ot(s),this.match=a,this.method=f}setCatchHandler(a){this.catchHandler=ot(a)}};E();var Nt=class extends le{constructor(a,s,f){let d=({url:v})=>{let w=a.exec(v.href);if(w&&!(v.origin!==location.origin&&w.index!==0))return w.slice(1)};super(d,s,f)}};E();E();var kt=class{constructor(){this._routes=new Map,this._defaultHandlerMap=new Map}get routes(){return this._routes}addFetchListener(){self.addEventListener("fetch",(a=>{let{request:s}=a,f=this.handleRequest({request:s,event:a});f&&a.respondWith(f)}))}addCacheListener(){self.addEventListener("message",(a=>{if(a.data&&a.data.type==="CACHE_URLS"){let{payload:s}=a.data,f=Promise.all(s.urlsToCache.map(d=>{typeof d=="string"&&(d=[d]);let v=new Request(...d);return this.handleRequest({request:v,event:a})}));a.waitUntil(f),a.ports&&a.ports[0]&&f.then(()=>a.ports[0].postMessage(!0))}}))}handleRequest({request:a,event:s}){let f=new URL(a.url,location.href);if(!f.protocol.startsWith("http"))return;let d=f.origin===location.origin,{params:v,route:w}=this.findMatchingRoute({event:s,request:a,sameOrigin:d,url:f}),D=w&&w.handler,$=[],J=a.method;if(!D&&this._defaultHandlerMap.has(J)&&(D=this._defaultHandlerMap.get(J)),!D)return;let X;try{X=D.handle({url:f,request:a,event:s,params:v})}catch(Ce){X=Promise.reject(Ce)}let re=w&&w.catchHandler;return X instanceof Promise&&(this._catchHandler||re)&&(X=X.catch(async Ce=>{if(re)try{return await re.handle({url:f,request:a,event:s,params:v})}catch(fe){fe instanceof Error&&(Ce=fe)}if(this._catchHandler)return this._catchHandler.handle({url:f,request:a,event:s});throw Ce})),X}findMatchingRoute({url:a,sameOrigin:s,request:f,event:d}){let v=this._routes.get(f.method)||[];for(let w of v){let D,$=w.match({url:a,sameOrigin:s,request:f,event:d});if($)return D=$,(Array.isArray(D)&&D.length===0||$.constructor===Object&&Object.keys($).length===0||typeof $=="boolean")&&(D=void 0),{route:w,params:D}}return{}}setDefaultHandler(a,s=vr){this._defaultHandlerMap.set(s,ot(a))}setCatchHandler(a){this._catchHandler=ot(a)}registerRoute(a){this._routes.has(a.method)||this._routes.set(a.method,[]),this._routes.get(a.method).push(a)}unregisterRoute(a){if(!this._routes.has(a.method))throw new H("unregister-route-but-not-found-with-method",{method:a.method});let s=this._routes.get(a.method).indexOf(a);if(s>-1)this._routes.get(a.method).splice(s,1);else throw new H("unregister-route-route-not-registered")}};var St,wr=()=>(St||(St=new kt,St.addFetchListener(),St.addCacheListener()),St);function Me(h,a,s){let f;if(typeof h=="string"){let v=new URL(h,location.href),w=({url:D})=>D.href===v.href;f=new le(w,a,s)}else if(h instanceof RegExp)f=new Nt(h,a,s);else if(typeof h=="function")f=new le(h,a,s);else if(h instanceof le)f=h;else throw new H("unsupported-route-type",{moduleName:"workbox-routing",funcName:"registerRoute",paramName:"capture"});return wr().registerRoute(f),f}E();E();E();function Mi(h,a=[]){for(let s of[...h.searchParams.keys()])a.some(f=>f.test(s))&&h.searchParams.delete(s);return h}function*Li(h,{ignoreURLParametersMatching:a=[/^utm_/,/^fbclid$/],directoryIndex:s="index.html",cleanURLs:f=!0,urlManipulation:d}={}){let v=new URL(h,location.href);v.hash="",yield v.href;let w=Mi(v,a);if(yield w.href,s&&w.pathname.endsWith("/")){let D=new URL(w.href);D.pathname+=s,yield D.href}if(f){let D=new URL(w.href);D.pathname+=".html",yield D.href}if(d){let D=d({url:v});for(let $ of D)yield $.href}}var Tt=class extends le{constructor(a,s){let f=({request:d})=>{let v=a.getURLsToCacheKeys();for(let w of Li(d.url,s)){let D=v.get(w);if(D){let $=a.getIntegrityForCacheKey(D);return{cacheKey:D,integrity:$}}}};super(f,a.strategy)}};function En(h){let a=Re(),s=new Tt(a,h);Me(s)}E();E();E();E();E();E();function xn(h){Re().precache(h)}E();function Rn(h,a){xn(h),En(a)}E();E();E();E();E();E();E();E();E();var Dt=class extends se{async _handle(a,s){let f=[],d=await s.cacheMatch(a),v;if(!d)try{d=await s.fetchAndCachePut(a)}catch(w){w instanceof Error&&(v=w)}if(!d)throw new H("no-response",{url:a.url,error:v});return d}};E();E();E();var br={cacheWillUpdate:async({response:h})=>h.status===200||h.status===0?h:null};var Ot=class extends se{constructor(a={}){super(a),this.plugins.some(s=>"cacheWillUpdate"in s)||this.plugins.unshift(br),this._networkTimeoutSeconds=a.networkTimeoutSeconds||0}async _handle(a,s){let f=[],d=[],v;if(this._networkTimeoutSeconds){let{id:$,promise:J}=this._getTimeoutPromise({request:a,logs:f,handler:s});v=$,d.push(J)}let w=this._getNetworkPromise({timeoutId:v,request:a,logs:f,handler:s});d.push(w);let D=await s.waitUntil((async()=>await s.waitUntil(Promise.race(d))||await w)());if(!D)throw new H("no-response",{url:a.url});return D}_getTimeoutPromise({request:a,logs:s,handler:f}){let d;return{promise:new Promise(w=>{d=setTimeout(async()=>{w(await f.cacheMatch(a))},this._networkTimeoutSeconds*1e3)}),id:d}}async _getNetworkPromise({timeoutId:a,request:s,logs:f,handler:d}){let v,w;try{w=await d.fetchAndCachePut(s)}catch(D){D instanceof Error&&(v=D)}return a&&clearTimeout(a),(v||!w)&&(w=await d.cacheMatch(s)),w}};E();var At=class extends se{constructor(a={}){super(a),this._networkTimeoutSeconds=a.networkTimeoutSeconds||0}async _handle(a,s){let f,d;try{let v=[s.fetch(a)];if(this._networkTimeoutSeconds){let w=gr(this._networkTimeoutSeconds*1e3);v.push(w)}if(d=await Promise.race(v),!d)throw new Error(`Timed out the network response after ${this._networkTimeoutSeconds} seconds.`)}catch(v){v instanceof Error&&(f=v)}if(!d)throw new H("no-response",{url:a.url,error:f});return d}};E();var Pt=class extends se{constructor(a={}){super(a),this.plugins.some(s=>"cacheWillUpdate"in s)||this.plugins.unshift(br)}async _handle(a,s){let f=[],d=s.fetchAndCachePut(a).catch(()=>{});s.waitUntil(d);let v=await s.cacheMatch(a),w;if(!v)try{v=await d}catch(D){D instanceof Error&&(w=D)}if(!v)throw new H("no-response",{url:a.url,error:w});return v}};E();E();E();function _r(h){h.then(()=>{})}E();E();E();var za=(h,a)=>a.some(s=>h instanceof s),Ui,Bi;function Ya(){return Ui||(Ui=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Qa(){return Bi||(Bi=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var $i=new WeakMap,Nn=new WeakMap,Fi=new WeakMap,Cn=new WeakMap,Sn=new WeakMap;function Xa(h){let a=new Promise((s,f)=>{let d=()=>{h.removeEventListener("success",v),h.removeEventListener("error",w)},v=()=>{s(pe(h.result)),d()},w=()=>{f(h.error),d()};h.addEventListener("success",v),h.addEventListener("error",w)});return a.then(s=>{s instanceof IDBCursor&&$i.set(s,h)}).catch(()=>{}),Sn.set(a,h),a}function Ja(h){if(Nn.has(h))return;let a=new Promise((s,f)=>{let d=()=>{h.removeEventListener("complete",v),h.removeEventListener("error",w),h.removeEventListener("abort",w)},v=()=>{s(),d()},w=()=>{f(h.error||new DOMException("AbortError","AbortError")),d()};h.addEventListener("complete",v),h.addEventListener("error",w),h.addEventListener("abort",w)});Nn.set(h,a)}var kn={get(h,a,s){if(h instanceof IDBTransaction){if(a==="done")return Nn.get(h);if(a==="objectStoreNames")return h.objectStoreNames||Fi.get(h);if(a==="store")return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return pe(h[a])},set(h,a,s){return h[a]=s,!0},has(h,a){return h instanceof IDBTransaction&&(a==="done"||a==="store")?!0:a in h}};function Vi(h){kn=h(kn)}function Za(h){return h===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(a,...s){let f=h.call(Er(this),a,...s);return Fi.set(f,a.sort?a.sort():[a]),pe(f)}:Qa().includes(h)?function(...a){return h.apply(Er(this),a),pe($i.get(this))}:function(...a){return pe(h.apply(Er(this),a))}}function es(h){return typeof h=="function"?Za(h):(h instanceof IDBTransaction&&Ja(h),za(h,Ya())?new Proxy(h,kn):h)}function pe(h){if(h instanceof IDBRequest)return Xa(h);if(Cn.has(h))return Cn.get(h);let a=es(h);return a!==h&&(Cn.set(h,a),Sn.set(a,h)),a}var Er=h=>Sn.get(h);function ji(h,a,{blocked:s,upgrade:f,blocking:d,terminated:v}={}){let w=indexedDB.open(h,a),D=pe(w);return f&&w.addEventListener("upgradeneeded",$=>{f(pe(w.result),$.oldVersion,$.newVersion,pe(w.transaction),$)}),s&&w.addEventListener("blocked",$=>s($.oldVersion,$.newVersion,$)),D.then($=>{v&&$.addEventListener("close",()=>v()),d&&$.addEventListener("versionchange",J=>d(J.oldVersion,J.newVersion,J))}).catch(()=>{}),D}function Wi(h,{blocked:a}={}){let s=indexedDB.deleteDatabase(h);return a&&s.addEventListener("blocked",f=>a(f.oldVersion,f)),pe(s).then(()=>{})}var ts=["get","getKey","getAll","getAllKeys","count"],rs=["put","add","delete","clear"],Tn=new Map;function qi(h,a){if(!(h instanceof IDBDatabase&&!(a in h)&&typeof a=="string"))return;if(Tn.get(a))return Tn.get(a);let s=a.replace(/FromIndex$/,""),f=a!==s,d=rs.includes(s);if(!(s in(f?IDBIndex:IDBObjectStore).prototype)||!(d||ts.includes(s)))return;let v=async function(w,...D){let $=this.transaction(w,d?"readwrite":"readonly"),J=$.store;return f&&(J=J.index(D.shift())),(await Promise.all([J[s](...D),d&&$.done]))[0]};return Tn.set(a,v),v}Vi(h=>({...h,get:(a,s,f)=>qi(a,s)||h.get(a,s,f),has:(a,s)=>!!qi(a,s)||h.has(a,s)}));E();try{self["workbox:expiration:7.3.0"]&&_()}catch{}var ns="workbox-expiration",It="cache-entries",Hi=h=>{let a=new URL(h,location.href);return a.hash="",a.href},xr=class{constructor(a){this._db=null,this._cacheName=a}_upgradeDb(a){let s=a.createObjectStore(It,{keyPath:"id"});s.createIndex("cacheName","cacheName",{unique:!1}),s.createIndex("timestamp","timestamp",{unique:!1})}_upgradeDbAndDeleteOldDbs(a){this._upgradeDb(a),this._cacheName&&Wi(this._cacheName)}async setTimestamp(a,s){a=Hi(a);let f={url:a,timestamp:s,cacheName:this._cacheName,id:this._getId(a)},v=(await this.getDb()).transaction(It,"readwrite",{durability:"relaxed"});await v.store.put(f),await v.done}async getTimestamp(a){let f=await(await this.getDb()).get(It,this._getId(a));return f?.timestamp}async expireEntries(a,s){let f=await this.getDb(),d=await f.transaction(It).store.index("timestamp").openCursor(null,"prev"),v=[],w=0;for(;d;){let $=d.value;$.cacheName===this._cacheName&&(a&&$.timestamp<a||s&&w>=s?v.push(d.value):w++),d=await d.continue()}let D=[];for(let $ of v)await f.delete(It,$.id),D.push($.url);return D}_getId(a){return this._cacheName+"|"+Hi(a)}async getDb(){return this._db||(this._db=await ji(ns,1,{upgrade:this._upgradeDbAndDeleteOldDbs.bind(this)})),this._db}};var Kt=class{constructor(a,s={}){this._isRunning=!1,this._rerunRequested=!1,this._maxEntries=s.maxEntries,this._maxAgeSeconds=s.maxAgeSeconds,this._matchOptions=s.matchOptions,this._cacheName=a,this._timestampModel=new xr(a)}async expireEntries(){if(this._isRunning){this._rerunRequested=!0;return}this._isRunning=!0;let a=this._maxAgeSeconds?Date.now()-this._maxAgeSeconds*1e3:0,s=await this._timestampModel.expireEntries(a,this._maxEntries),f=await self.caches.open(this._cacheName);for(let d of s)await f.delete(d,this._matchOptions);this._isRunning=!1,this._rerunRequested&&(this._rerunRequested=!1,_r(this.expireEntries()))}async updateTimestamp(a){await this._timestampModel.setTimestamp(a,Date.now())}async isURLExpired(a){if(this._maxAgeSeconds){let s=await this._timestampModel.getTimestamp(a),f=Date.now()-this._maxAgeSeconds*1e3;return s!==void 0?s<f:!0}else return!1}async delete(){this._rerunRequested=!1,await this._timestampModel.expireEntries(1/0)}};E();E();function Gi(h){mr.add(h)}var Mt=class{constructor(a={}){this.cachedResponseWillBeUsed=async({event:s,request:f,cacheName:d,cachedResponse:v})=>{if(!v)return null;let w=this._isResponseDateFresh(v),D=this._getCacheExpiration(d);_r(D.expireEntries());let $=D.updateTimestamp(f.url);if(s)try{s.waitUntil($)}catch{}return w?v:null},this.cacheDidUpdate=async({cacheName:s,request:f})=>{let d=this._getCacheExpiration(s);await d.updateTimestamp(f.url),await d.expireEntries()},this._config=a,this._maxAgeSeconds=a.maxAgeSeconds,this._cacheExpirations=new Map,a.purgeOnQuotaError&&Gi(()=>this.deleteCacheAndMetadata())}_getCacheExpiration(a){if(a===xe.getRuntimeName())throw new H("expire-custom-caches-only");let s=this._cacheExpirations.get(a);return s||(s=new Kt(a,this._config),this._cacheExpirations.set(a,s)),s}_isResponseDateFresh(a){if(!this._maxAgeSeconds)return!0;let s=this._getDateHeaderTimestamp(a);if(s===null)return!0;let f=Date.now();return s>=f-this._maxAgeSeconds*1e3}_getDateHeaderTimestamp(a){if(!a.headers.has("date"))return null;let s=a.headers.get("date"),d=new Date(s).getTime();return isNaN(d)?null:d}async deleteCacheAndMetadata(){for(let[a,s]of this._cacheExpirations)await self.caches.delete(a),await s.delete();this._cacheExpirations=new Map}};E();E();var Rr=qa(zi(),1),Yi=Symbol.for("Dexie"),Cr=globalThis[Yi]||(globalThis[Yi]=Rr.default);if(Rr.default.semVer!==Cr.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Rr.default.semVer} and ${Cr.semVer}`);var{liveQuery:im,mergeRanges:om,rangesOverlap:am,RangeSet:sm,cmp:um,Entity:cm,PropModification:lm,replacePrefix:fm,add:hm,remove:pm,DexieYProvider:dm}=Cr;var Qi=Cr;var An=class extends Qi{constructor(){super("VynkLocalDB");Ke(this,"messages");Ke(this,"stories");Ke(this,"conversations");Ke(this,"queue");Ke(this,"meta");Ke(this,"users");Ke(this,"participants");this.version(3).stores({messages:"++id, messageId, conversationId, timestamp",stories:"++id, storyId, expiresAt",conversations:"++id, conversationId, updatedAt, type",queue:"++id, action, timestamp",meta:"key",settings:"id",calls:"++id, status",users:"id, name, updatedAt",participants:"id, conversationId, userId"})}async cleanupOldStories(){let s=Date.now();await this.stories.where("expiresAt").below(s).delete()}async enqueue(s,f){await this.queue.add({action:s,payload:f,timestamp:Date.now()}),typeof navigator<"u"&&navigator.onLine&&this.sync().catch(console.error)}async sync(){if(!(typeof navigator>"u"||!navigator.onLine))try{await this.flushQueue(),await this.pullDelta()}catch(s){console.error("Sync failed",s)}}async flushQueue(){let s=await this.queue.orderBy("timestamp").toArray();if(s.length===0)return;let f=await fetch("/api/sync",{method:"POST",body:JSON.stringify(s),headers:{"Content-Type":"application/json"}});if(!f.ok)throw new Error("Flush failed");if((await f.json()).success){let v=s.map(w=>w.id);await this.queue.bulkDelete(v)}}async pullDelta(){let f=(await this.meta.get("lastSyncedAt"))?.value||new Date(0).toISOString(),d=await fetch(`/api/sync?since=${f}`);if(!d.ok)throw new Error("Pull failed");let v=await d.json();v.conversations?.length&&await this.syncConversations(v.conversations),v.messages?.length&&await this.syncMessages(v.messages),v.stories?.length&&await this.syncStories(v.stories),v.users?.length&&await this.syncUsers(v.users),v.deletedMessageIds?.length&&await this.messages.where("messageId").anyOf(v.deletedMessageIds).delete(),v.deletedStoryIds?.length&&await this.stories.where("storyId").anyOf(v.deletedStoryIds).delete(),v.deletedConversationIds?.length&&await this.conversations.where("conversationId").anyOf(v.deletedConversationIds).delete(),await this.meta.put({key:"lastSyncedAt",value:v.timestamp})}async syncUsers(s){for(let f of s)await this.users.put(f)}async syncConversations(s){for(let f of s){let d=await this.conversations.where("conversationId").equals(f.conversationId).first();d?await this.conversations.update(d.id,{...f,isVirtual:!1}):await this.conversations.add({...f,isVirtual:!1})}}async syncMessages(s){for(let f of s){if(!f.messageId)continue;let d=await this.messages.where("messageId").equals(f.messageId).first();d?await this.messages.update(d.id,f):await this.messages.add(f)}}async syncStories(s){for(let f of s){if(!f.storyId)continue;let d=await this.stories.where("storyId").equals(f.storyId).first();d?await this.stories.update(d.id,f):await this.stories.add(f)}}async syncParticipants(s){for(let f of s)await this.participants.put(f)}async performInitialSync(){try{let s=await fetch("/api/initial-sync");if(!s.ok)throw new Error("Initial sync failed");let f=await s.json();if(f.users?.length&&await this.users.bulkPut(f.users),f.conversations?.length)for(let d of f.conversations){let v={conversationId:d.conversationId,title:d.title,type:d.type,groupImg:d.groupImg,createdAt:d.createdAt,updatedAt:d.updatedAt,lastMessage:d.lastMessage,lastMessageAt:d.lastMessageAt,unreadCount:d.unreadCount,isVirtual:!1,displayName:d.title,displayAvatar:d.groupImg};if(await this.conversations.put(v),d.participants?.length)for(let w of d.participants)await this.participants.put({id:w.odId,conversationId:w.odConversationId,userId:w.odUserId,role:w.role,unreadCount:w.unreadCount})}return await this.meta.put({key:"lastSyncedAt",value:f.timestamp}),await this.meta.put({key:"initialSyncCompleted",value:!0}),{success:!0}}catch(s){return console.error("Initial sync error:",s),{success:!1,error:s}}}async isInitialSyncCompleted(){return(await this.meta.get("initialSyncCompleted"))?.value===!0}async getConversationDisplayInfo(s,f){let d=await this.conversations.where("conversationId").equals(s).first();if(!d)return{name:"Unknown",avatar:null};if(d.type==="group")return{name:d.title||"Group",avatar:d.groupImg||null};let w=(await this.participants.where("conversationId").equals(s).toArray()).find(D=>D.userId!==f);if(w){let D=await this.users.get(w.userId);if(D)return{name:D.name,avatar:D.avatar}}return{name:d.title||"Unknown",avatar:null}}async createVirtualConversation(s,f){let d=await this.users.get(s);if(!d)return null;let v=await this.participants.where("userId").equals(s).first();if(v&&await this.participants.where("conversationId").equals(v.conversationId).filter(J=>J.userId===f).first())return v.conversationId;let w=`virtual-${f}-${s}`;return await this.conversations.where("conversationId").equals(w).first()||(await this.conversations.add({conversationId:w,title:d.name,type:"private",createdAt:Date.now(),updatedAt:Date.now(),unreadCount:0,isVirtual:!0,displayName:d.name,displayAvatar:d.avatar}),await this.participants.bulkAdd([{id:`${w}_${f}`,conversationId:w,userId:f,role:"member",unreadCount:0},{id:`${w}_${s}`,conversationId:w,userId:s,role:"member",unreadCount:0}])),w}async persistVirtualConversation(s,f){let d=await this.conversations.where("conversationId").equals(s).first();if(!d)return;await this.conversations.update(d.id,{conversationId:f,isVirtual:!1});let v=await this.participants.where("conversationId").equals(s).toArray();for(let w of v)await this.participants.delete(w.id),await this.participants.add({...w,id:`${f}_${w.userId}`,conversationId:f})}async clearAllData(){await this.messages.clear(),await this.stories.clear(),await this.conversations.clear(),await this.users.clear(),await this.participants.clear(),await this.queue.clear(),await this.meta.clear()}},Pn=new An;var Xi="sync-queue",at={IMAGES:"images-v1",STATIC:"static-v1",PAGES:"pages-v1",MAX_IMAGES:60,IMAGE_MAX_AGE:720*60*60,NAV_TIMEOUT:3};Rn(P||[]);self.addEventListener("install",()=>{self.skipWaiting()});self.addEventListener("activate",h=>{h.waitUntil(self.clients.claim())});Me(({url:h,request:a})=>h.pathname.startsWith("/api/auth")||a.method==="POST",new At);Me(({request:h})=>h.destination==="image",new Dt({cacheName:at.IMAGES,plugins:[new Mt({maxEntries:at.MAX_IMAGES,maxAgeSeconds:at.IMAGE_MAX_AGE,purgeOnQuotaError:!0})]}));Me(({request:h})=>h.destination==="script"||h.destination==="style",new Pt({cacheName:at.STATIC}));Me(({request:h})=>h.mode==="navigate",new Ot({cacheName:at.PAGES,networkTimeoutSeconds:at.NAV_TIMEOUT}));self.addEventListener("sync",h=>{let a=h;a.tag===Xi&&a.waitUntil(is())});async function is(){let h=await Pn.queue.orderBy("timestamp").toArray();if(h.length!==0)try{let a=await fetch("/api/sync",{method:"POST",body:JSON.stringify(h),headers:{"Content-Type":"application/json"}});if(a.status>=500)throw new Error(`Server error: ${a.status}`);if(!a.ok){console.error("[SW] Batch sync rejected:",await a.text());return}let{results:s}=await a.json();await os(h,s)}catch(a){throw console.error("[SW] Sync failed:",a),a}}async function os(h,a){if(!Array.isArray(a))return;let s=[],f=[];for(let v of a)v.status==="success"&&v.id?s.push(v.id):v.status==="failed"&&v.id&&(console.warn(`[SW] Item ${v.id} failed: ${v.error}`),f.push(v.id));let d=[...s,...f];d.length>0&&await Pn.queue.bulkDelete(d),await as(h,s)}async function as(h,a){let s=await self.clients.matchAll({type:"window"});for(let f of h)if(f.id&&a.includes(f.id)){let d={type:"OpSynced",action:f.action,originalId:f.id};for(let v of s)v.postMessage(d)}}self.addEventListener("push",h=>{let a=h,s={title:"Vynk",body:"You have a new notification",icon:"/icons/icon-192x192.png",badge:"/icons/badge-72x72.png"},f=s;if(a.data)try{let d=a.data.json();f={title:d.title||s.title,body:d.body||s.body,icon:d.icon||s.icon,badge:d.badge||s.badge}}catch{}a.waitUntil(self.registration.showNotification(f.title,{body:f.body,icon:f.icon,badge:f.badge,tag:"vynk-notification"}))});self.addEventListener("notificationclick",h=>{h.notification.close(),h.waitUntil(self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(a=>{for(let s of a)if("focus"in s)return s.focus();return self.clients.openWindow("/")}))});self.addEventListener("message",h=>{let{type:a}=h.data||{};switch(a){case"SKIP_WAITING":self.skipWaiting();break;case"TRIGGER_SYNC":self.registration.sync?.register(Xi).catch(s=>console.warn("[SW] Sync registration failed:",s));break;case"GET_VERSION":h.ports[0]?.postMessage({version:"1.0.0"});break}});})();
/*! Bundled license information:

dexie/dist/dexie.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)
*/
